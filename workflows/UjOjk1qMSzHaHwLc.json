{"updatedAt":"2025-11-24T10:26:20.119Z","createdAt":"2025-11-24T09:38:28.676Z","id":"UjOjk1qMSzHaHwLc","name":"Search BunkerWeb through Medium","active":false,"isArchived":false,"nodes":[{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":2},"conditions":[{"id":"7cad6d4b-88fa-41fd-8b1c-49251513eb17","leftValue":"={{ $json.in_cache }}","rightValue":"=1","operator":{"type":"string","operation":"notEquals"}}],"combinator":"and"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.filter","typeVersion":2.2,"position":[144,-752],"id":"5f16c676-649f-46ac-a441-74f7d6d7fa6f","name":"Hasn't been processed already"},{"parameters":{"operation":"get","propertyName":"in_cache","key":"=hn_{{ $json.id }}","options":{}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[-304,-656],"id":"7a311566-fa0e-4b41-a3e2-2719b13a10db","name":"Get cached ID"},{"parameters":{"mode":"combine","combineBy":"combineByPosition","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[-80,-752],"id":"a57f8805-a851-4a19-b26d-a40a142133fd","name":"Merge cached response and entity"},{"parameters":{"content":"## ðŸ’¾ Filter already processed statuses.","height":352,"width":640,"color":3},"type":"n8n-nodes-base.stickyNote","position":[-352,-848],"typeVersion":1,"id":"d5ee07bd-41a1-433f-b777-93425babff21","name":"Sticky Note3"},{"parameters":{"sortFieldsUi":{"sortField":[{"fieldName":"created_at"}]},"options":{}},"type":"n8n-nodes-base.sort","typeVersion":1,"position":[1488,-800],"id":"3b9f6d3a-ff73-42a3-96e1-e59a49a5f602","name":"Sort by creation date"},{"parameters":{"authentication":"webhook","content":"=","options":{"wait":true},"embeds":{"values":[{"description":"={{ $json.content }}","author":"={{ $json.author }}","color":"#ff4000","timestamp":"={{ $json.created_at }}","title":"=ðŸ§‘â€ðŸ’» New Hacker News {{ $json.type }}!","url":"={{ $json.hn_url }}"}]}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[1936,-832],"id":"9a0cbe9f-b808-4f74-b1e4-7a1c439266d2","name":"Alert discord","webhookId":"b45ec7a0-3825-4059-91c0-117fd1e6158d","retryOnFail":true,"waitBetweenTries":5000},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[1712,-800],"id":"991aa835-e99a-4ea1-a3bf-4a137a18d942","name":"Loop Over Items"},{"parameters":{"amount":1},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[2736,-848],"id":"b2712ae0-fc8e-4aac-b2b2-317d10bdd077","name":"Wait 1 second","webhookId":"c727988f-c4c5-4fc8-83f8-eeea10b21ef3"},{"parameters":{"content":"## ðŸ“¨ Inform the Bunker team on Discord and save processed entities in the cache","height":320,"width":1248,"color":6},"type":"n8n-nodes-base.stickyNote","position":[1648,-960],"typeVersion":1,"id":"00e7225f-8a6b-482a-a05b-8aec925b76e0","name":"Sticky Note2"},{"parameters":{"operation":"set","key":"=hn_{{ $json.id }}","value":"1","expire":true,"ttl":"={{ DateTime.fromSeconds(0).plus(1, \"month\").toSeconds() }}"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[2512,-928],"id":"8690c660-2909-4859-8031-75eba3ed783f","name":"Save processed ID"},{"parameters":{"assignments":{"assignments":[{"id":"955d62d6-8516-4ba3-85ff-1c9d16cc679c","name":"created_at","value":"={{ DateTime.fromISO($json.created_at) }}","type":"string"}]},"includeOtherFields":true,"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1264,-800],"id":"ad4aa846-a0c1-46f4-96fa-cc7894926afd","name":"Convert date string to datetime"},{"parameters":{"mode":"combine","combineBy":"combineByPosition","options":{"clashHandling":{"values":{"resolveClash":"preferInput1"}}}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[2224,-928],"id":"c830c22a-85af-4ec1-90d1-77fc9c9f9347","name":"Merge tweet data with discord response"},{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-1200,176],"id":"7ea3d494-5218-4a65-b3cc-0f412193142e","name":"Clear processed IDs"},{"parameters":{"jsCode":"return Object.keys($input.first().json).map(k => {\n  return { json: { key: k } };\n});"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-752,176],"id":"67a12700-9e98-43b3-b3da-7f6ae1b6f841","name":"Extract keys"},{"parameters":{"operation":"delete","key":"={{ $json.key }}"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[-528,176],"id":"b7e50d86-d277-4c5d-86cc-c6a3ff1da82e","name":"Delete extracted keys"},{"parameters":{"jsCode":"// Input: Algolia HN search API response with \"hits\"\n// Output: one item per hit, normalized with all useful fields\n\nconst out = [];\nconst seen = new Set();\n\nfor (const item of items) {\n  const hits = (item.json && item.json.hits) || [];\n  for (const h of hits) {\n    const id = h.objectID;\n    if (!id || seen.has(id)) continue;\n    seen.add(id);\n\n    const isComment = (h._tags || []).includes('comment');\n\n    // Main title: use comment snippet or story title\n    const title =\n      h.title ||\n      h.story_title ||\n      (isComment ? '(comment)' : '(no title)');\n\n    // Direct story link (if any)\n    const storyUrl = h.url || h.story_url || null;\n\n    // Always provide the HN discussion link\n    const hnUrl = `https://news.ycombinator.com/item?id=${id}`;\n\n    out.push({\n      json: {\n        // Basic identifiers\n        id,\n        type: isComment ? 'comment' : 'story',\n        author: h.author ?? null,\n\n        // Content\n        title,\n        story_url: storyUrl,\n        hn_url: hnUrl,\n        comment_text: h.comment_text ?? null,\n\n        // Metadata\n        points: h.points ?? null,\n        num_comments: h.num_comments ?? null,\n        created_at: h.created_at ?? null,     // ISO timestamp\n        created_at_i: h.created_at_i ?? null, // epoch seconds\n        story_id: h.story_id ?? null,\n        parent_id: h.parent_id ?? null,\n        tags: h._tags || [],\n\n        // Raw for debugging\n        raw: h\n      }\n    });\n  }\n}\n\nreturn out;\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-752,-752],"id":"497a760d-e446-40f8-a44b-eefa48492c1f","name":"Parse hits"},{"parameters":{"operation":"keys","keyPattern":"hn_*"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[-976,176],"id":"6768c5c4-d8c0-4df2-8493-90af3f85e54b","name":"Get all hn_* keys"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"62a0f7f4-a08a-4c72-9b71-2279befb46cc","leftValue":"={{ $json.type }}","rightValue":"story","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[368,-752],"id":"5f94c623-02c4-4b63-a952-cf8cbe5f5d8a","name":"If is a story"},{"parameters":{"keys":{"key":[{"currentKey":"title","newKey":"content"}]},"additionalOptions":{}},"type":"n8n-nodes-base.renameKeys","typeVersion":1,"position":[816,-944],"id":"c47a81b3-f796-494b-827e-6d918e5a9bcc","name":"Rename title -> content"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[592,-192],"id":"9475a331-03b7-485f-880a-47d42d67390b","name":"Loop Over entities"},{"parameters":{"content":"### ðŸ“ Convert the HTML comment to markdown using Gemini 2.5 flash and fallback to llama3.2.","height":432,"width":560,"color":5},"type":"n8n-nodes-base.stickyNote","position":[2112,-336],"typeVersion":1,"id":"34c05b40-5e49-43ce-86c2-2a56d21112dc","name":"Sticky Note"},{"parameters":{"content":"## â³ Handle Gemini 2.5 flash API rate limit (10 requests per minute).","height":640,"width":1520,"color":4},"type":"n8n-nodes-base.stickyNote","position":[560,-528],"typeVersion":1,"id":"fb37fec1-b402-4b88-9658-b062b4d5c3da","name":"Sticky Note1"},{"parameters":{"mode":"combine","combineBy":"combineByPosition","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[816,-704],"id":"b3a570fc-2552-4606-9881-02f78cf0d188","name":"Merge summary"},{"parameters":{"keys":{"key":[{"currentKey":"text","newKey":"content"}]},"additionalOptions":{}},"type":"n8n-nodes-base.renameKeys","typeVersion":1,"position":[2512,-144],"id":"93f5356e-af0f-4b12-8564-a4444b209482","name":"Rename output -> summary"},{"parameters":{"model":"llama3.2:3b","options":{"lowVram":true,"useMLock":true,"useMMap":true}},"type":"@n8n/n8n-nodes-langchain.lmChatOllama","typeVersion":1,"position":[2304,-48],"id":"69418312-6897-4094-9e35-48b062d62fe8","name":"llama3.2"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[2176,-48],"id":"f0c40c74-d564-4c1c-8ccd-54bfbd2ec9c9","name":"Gemini 2.5 flash"},{"parameters":{"amount":65},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[1488,-416],"id":"3d1d5218-1b04-43a7-8aea-614b804d6f01","name":"Wait for the gemini API rate limit to end","webhookId":"7cfa121d-25c6-4b24-8d15-7809128b0e20"},{"parameters":{"operation":"get","propertyName":"gemini_flash_executions","key":"gemini_flash_executions","options":{}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[816,-48],"id":"ef6d74af-6e04-4b19-b58d-8276481f6205","name":"Get gemini flash executions"},{"parameters":{"mode":"combine","combineBy":"combineByPosition","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[1040,-192],"id":"77962664-ec01-48fe-b430-22ebce35d0c7","name":"Add gemini_flash_executions key"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":2},"conditions":[{"id":"8152c702-f81c-471b-a7bc-33c4fedc9593","leftValue":"={{ $json.gemini_flash_executions }}","rightValue":10,"operator":{"type":"number","operation":"gte"}}],"combinator":"and"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1264,-192],"id":"8641581a-5505-4c2c-9405-a9e0c7cf7eb8","name":"If there's been 10 executions or more"},{"parameters":{"operation":"delete","key":"gemini_flash_executions"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[1712,-480],"id":"bdd580b3-974f-48ba-a0d4-911e72dc9b2c","name":"Delete gemini_flash_executions"},{"parameters":{"operation":"incr","key":"gemini_flash_executions","expire":true,"ttl":65},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[1488,-48],"id":"5f5872da-668f-4c90-bb32-a8d646e0e71f","name":"Increment gemini_flash_executions"},{"parameters":{"promptType":"define","text":"=You are an expert text converter. Convert the given HTML into clean, Discord-compatible Markdown formatting.  \n- Preserve text meaning while removing unsupported tags.  \n- Convert <b> and <strong> to **bold**.  \n- Convert <i> and <em> to *italic*.  \n- Convert <u> to __underline__.  \n- Convert <a href=\"URL\">text</a> into [text](URL).  \n- Convert <code> and <pre> into inline code or code blocks with backticks.  \n- Convert lists (<ul>, <ol>, <li>) into proper Markdown bullet points or numbered lists.  \n- Remove any remaining raw HTML that Discord cannot render.  \n\nInput: {{ $json.comment_text }}\nOutput: Discord-ready Markdown.","needsFallback":true,"batching":{}},"type":"@n8n/n8n-nodes-langchain.chainLlm","typeVersion":1.7,"position":[2160,-272],"id":"82ad7587-6753-4929-9eb0-9c2c0d62bb79","name":"HTML -> Markdown"},{"parameters":{"mode":"combine","combineBy":"combineByPosition","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[1712,-128],"id":"c31c3202-6d14-48a2-a4e8-d0e3fcc97b76","name":"Merge increment"},{"parameters":{"mode":"combine","combineBy":"combineByPosition","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[1936,-416],"id":"6de9ab71-9fea-406d-803b-56fe96730084","name":"Merge wait"},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[1040,-800],"id":"920ccd86-8355-4f15-b58e-1427dc4ac54e","name":"Merge all"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"6c92d84b-d044-4b44-82ec-f1a50f31ebaa","leftValue":"={{ $json.created_at }}","rightValue":"={{ $now.minus('1', 'day') }}","operator":{"type":"dateTime","operation":"afterOrEquals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.filter","typeVersion":2.2,"position":[-528,-752],"id":"10367c76-8f82-4e71-acf4-5252c56c1101","name":"Created in the last 24H"},{"parameters":{"rule":{"interval":[{"field":"hours","hoursInterval":4}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-1200,-752],"id":"b628f602-570d-43d9-8319-262eb68b07c9","name":"Every 4 hour"},{"parameters":{"url":"https://medium.com/feed/tag/technology","sendHeaders":true,"headerParameters":{"parameters":[{"name":"User-Agent","value":"Mozilla/5.0 (Macintosh; Intel Mac OS X 11_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4619.141 Safari/537.36"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-976,-752],"id":"7abb43cc-f6c1-4221-9a53-98fa3d7aab75","name":"Fetch Medium RSS feed"}],"connections":{"Hasn't been processed already":{"main":[[{"node":"If is a story","type":"main","index":0}]]},"Get cached ID":{"main":[[{"node":"Merge cached response and entity","type":"main","index":1}]]},"Merge cached response and entity":{"main":[[{"node":"Hasn't been processed already","type":"main","index":0}]]},"Sort by creation date":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Alert discord":{"main":[[{"node":"Merge tweet data with discord response","type":"main","index":1}]]},"Loop Over Items":{"main":[[],[{"node":"Merge tweet data with discord response","type":"main","index":0},{"node":"Alert discord","type":"main","index":0}]]},"Wait 1 second":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Save processed ID":{"main":[[{"node":"Wait 1 second","type":"main","index":0}]]},"Convert date string to datetime":{"main":[[{"node":"Sort by creation date","type":"main","index":0}]]},"Merge tweet data with discord response":{"main":[[{"node":"Save processed ID","type":"main","index":0}]]},"Clear processed IDs":{"main":[[{"node":"Get all hn_* keys","type":"main","index":0}]]},"Extract keys":{"main":[[{"node":"Delete extracted keys","type":"main","index":0}]]},"Parse hits":{"main":[[{"node":"Created in the last 24H","type":"main","index":0}]]},"Get all hn_* keys":{"main":[[{"node":"Extract keys","type":"main","index":0}]]},"If is a story":{"main":[[{"node":"Rename title -> content","type":"main","index":0}],[{"node":"Merge summary","type":"main","index":0},{"node":"Loop Over entities","type":"main","index":0}]]},"Rename title -> content":{"main":[[{"node":"Merge all","type":"main","index":0}]]},"Loop Over entities":{"main":[[{"node":"Merge summary","type":"main","index":1}],[{"node":"Get gemini flash executions","type":"main","index":0},{"node":"Add gemini_flash_executions key","type":"main","index":0}]]},"Rename output -> summary":{"main":[[{"node":"Loop Over entities","type":"main","index":0}]]},"llama3.2":{"ai_languageModel":[[{"node":"HTML -> Markdown","type":"ai_languageModel","index":1}]]},"Gemini 2.5 flash":{"ai_languageModel":[[{"node":"HTML -> Markdown","type":"ai_languageModel","index":0}]]},"Wait for the gemini API rate limit to end":{"main":[[{"node":"Delete gemini_flash_executions","type":"main","index":0},{"node":"Merge wait","type":"main","index":1}]]},"Get gemini flash executions":{"main":[[{"node":"Add gemini_flash_executions key","type":"main","index":1}]]},"Add gemini_flash_executions key":{"main":[[{"node":"If there's been 10 executions or more","type":"main","index":0}]]},"If there's been 10 executions or more":{"main":[[{"node":"Wait for the gemini API rate limit to end","type":"main","index":0}],[{"node":"Increment gemini_flash_executions","type":"main","index":0},{"node":"Merge increment","type":"main","index":0}]]},"Merge summary":{"main":[[{"node":"Merge all","type":"main","index":1}]]},"HTML -> Markdown":{"main":[[{"node":"Rename output -> summary","type":"main","index":0}]]},"Increment gemini_flash_executions":{"main":[[{"node":"Merge increment","type":"main","index":1}]]},"Merge increment":{"main":[[{"node":"HTML -> Markdown","type":"main","index":0}]]},"Delete gemini_flash_executions":{"main":[[{"node":"Merge wait","type":"main","index":0}]]},"Merge wait":{"main":[[{"node":"HTML -> Markdown","type":"main","index":0}]]},"Merge all":{"main":[[{"node":"Convert date string to datetime","type":"main","index":0}]]},"Created in the last 24H":{"main":[[{"node":"Merge cached response and entity","type":"main","index":0},{"node":"Get cached ID","type":"main","index":0}]]},"Every 4 hour":{"main":[[{"node":"Fetch Medium RSS feed","type":"main","index":0}]]},"Fetch Medium RSS feed":{"main":[[]]}},"settings":{"executionOrder":"v1"},"staticData":{"node:Every day":{"recurrenceRules":[]},"node:Every hour":{"recurrenceRules":[]},"node:Every 4 hour":{"recurrenceRules":[8]}},"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"f76d9430-c086-44db-bd24-c97150a294a9","triggerCount":1,"shared":[{"updatedAt":"2025-11-24T09:38:28.676Z","createdAt":"2025-11-24T09:38:28.676Z","role":"workflow:owner","workflowId":"UjOjk1qMSzHaHwLc","projectId":"ZjBkzD6jhnG4YX2d"}],"tags":[{"updatedAt":"2025-08-13T09:13:48.874Z","createdAt":"2025-08-13T09:13:48.874Z","id":"Af5V1Rr0ynGVFcvN","name":"Social"}]}