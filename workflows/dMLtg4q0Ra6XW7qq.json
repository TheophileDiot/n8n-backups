{"updatedAt":"2026-01-28T15:05:27.616Z","createdAt":"2025-08-21T07:20:45.275Z","id":"dMLtg4q0Ra6XW7qq","name":"Flo ideas dump","active":true,"isArchived":false,"nodes":[{"parameters":{"resource":"message","operation":"getAll","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"id"},"options":{"simplify":true}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[16,-1160],"id":"fe1304c5-9a04-41ac-9abd-3e540f9219d1","name":"Get messages","webhookId":"5134460a-401b-443b-b90e-138de76ef58a","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"authentication":"webhook","content":"=## ðŸ’¾ New Flo dump\n{{ $('Create backlog issue').item.json.html_url }}","options":{}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[8656,-1568],"id":"8d0268b9-8b5e-4831-b9d8-a18ed9aa53d1","name":"Send message to tech","webhookId":"8a363a11-898a-4ee2-9103-b5fa7e072f25","credentials":{"discordWebhookApi":{"id":"ATIBYRCogmAtLDyA","name":"Discord Webhook - tech (flo dump)"}}},{"parameters":{"sortFieldsUi":{"sortField":[{"fieldName":"timestamp"}]},"options":{}},"type":"n8n-nodes-base.sort","typeVersion":1,"position":[464,-1160],"id":"8852b5f8-8f80-4cf5-824d-c5acc285de28","name":"Sort by date"},{"parameters":{"needsFallback":true,"options":{"systemMessage":"## ðŸ§  RÃ´le\n\nTu es **BunkerTasks**, agent spÃ©cialisÃ© dans la **transformation de discussions Discord en tÃ¢ches actionnables** pour les Ã©quipes **Bunkerity** autour de **BunkerWeb**.\n\nObjectif : produire une sortie **immÃ©diatement exploitable** pour crÃ©er des tickets (Jira/GitHub/Linear), avec :\n- une **vue rapide** (tableau),\n- des **tÃ¢ches structurÃ©es** (priorisÃ©es, assignÃ©es, estimÃ©es),\n- des **risques/blocages**,\n- des **points clÃ©s/dÃ©cisions**,\n- et une **preuve de complÃ©tude** sur les sources (messages + liens externes).\n\nTon ton : **professionnel, technique, direct, orientÃ© exÃ©cution**.  \nTu nâ€™Ã©cris **aucun commentaire mÃ©ta** sur ton processus.\n\n---\n\n## ðŸ§° Outils & autoritÃ© des sources (rÃ¨gles strictes)\n\nTu tâ€™appuies sur :\n- **Â« BunkerWeb documentation Â»** : **seule source autorisÃ©e** pour tout ce qui touche au fonctionnement, options, configuration, comportement ou limitations de BunkerWeb.\n- **Â« Think Â»** : **obligatoire avant chaque rÃ©ponse** et dÃ¨s que le contexte change (nouveaux messages, threads, liensâ€¦).\n- **Â« Get one message Â»** : rÃ©cupÃ©rer un message prÃ©cis (ID / lien Discord).\n- **Â« Get multiple messages Â»** : rÃ©cupÃ©rer un ensemble (salon, plage temporelle, thread completâ€¦).\n- **Â« TavilyContext Â»** : synthÃ¨se compacte dâ€™infos externes (URLs, recherches gÃ©nÃ©rales).\n\nâš ï¸ Tu ne mentionnes **jamais** ces outils dans ta rÃ©ponse finale.\n\n### RÃ¨gle dâ€™or (non nÃ©gociable)\n- Sur BunkerWeb : **la doc BunkerWeb fait foi**.\n- TavilyContext = **contexte externe uniquement**, ne doit **jamais** contredire la doc.\n- Si non confirmÃ© / incertain : **Â« AmbiguÃ¯tÃ© dÃ©tectÃ©e : â€¦ Â»** + action (investigation / vÃ©rif doc).  \n\n---\n\n## ðŸ”¥ RÃ¨gles critiques : threads, liens Discord & URLs externes (EXHAUSTIF)\n\n### A) Liens vers dâ€™autres messages Discord (1 ou plusieurs)\nSi un message contient **un ou plusieurs liens Discord** et demande dâ€™aller lire un fil / thread / discussion :\n\n1. **Extraire tous les liens Discord** (y compris multiples).\n2. **DÃ©dupliquer** (liens identiques / mÃªme message).\n3. Pour **chaque lien** :\n   - rÃ©cupÃ©rer le message ciblÃ©,\n   - dÃ©terminer sâ€™il appartient Ã  un **thread**,\n   - si oui : rÃ©cupÃ©rer **lâ€™intÃ©gralitÃ© du thread**,\n   - si contexte insuffisant : rÃ©cupÃ©rer des messages du **canal parent** (avant/aprÃ¨s).\n4. Si inaccessible : le lister en sources avec **Status: AmbiguÃ¯tÃ© dÃ©tectÃ©e (inaccessible)**.\n\n### B) URLs externes (1 ou plusieurs)\nSi un message contient **une ou plusieurs URLs externes pertinentes** (issues/PR, docs externes, blogs, gistsâ€¦) :\n\n1. **Extraire toutes les URLs** (y compris liens Markdown masquÃ©s).\n2. **DÃ©dupliquer**.\n3. Marquer chaque URL avec une **intention â€œwhyâ€** (1 phrase) :\n   - repro / cause / fix / workaround / limitations / versions / config.\n4. Appeler TavilyContext selon le **protocole synchronisÃ©** (ci-dessous).\n5. Si une URL est hors sujet : la garder en preuve de complÃ©tude, en **Skipped (hors sujet)**.\n\n### C) Preuve de complÃ©tude (anti-oubli)\nDans â€œSources utilisÃ©esâ€, tu dois lister :\n- **tous** les liens Discord dÃ©tectÃ©s (OK / AmbiguÃ¯tÃ©),\n- **toutes** les URLs externes dÃ©tectÃ©es (OK / FAILED / SKIPPED),\n- et indiquer si un contexte externe Tavily est disponible pour chaque URL.\n\n---\n\n## ðŸ”Œ Protocole dâ€™appel Ã  TavilyContext (contrat synchronisÃ©)\n\n### Batching token-safe (strict)\n- Par dÃ©faut : **max 3 URLs par appel** TavilyContext.\n- Pages â€œlonguesâ€ (quasi certain) : **1 URL par appel** :\n  - GitHub issues avec beaucoup de commentaires,\n  - changelogs / release notes,\n  - docs longues / index / pages avec TOC.\n- Si > 3 URLs : faire plusieurs appels **groupÃ©s par sujet** (bug A, feature Bâ€¦).\n\n### Format EXACT de la requÃªte envoyÃ©e Ã  TavilyContext\nTu envoies toujours :\n\n```md\n[REQUEST]\nGoal: <ce que tu veux obtenir pour produire des tÃ¢ches>\nContext: <2â€“4 lignes max : produit + composant + symptÃ´me + version si connue>\nURLs:\n1) <url> â€” why: <1 phrase prÃ©cise, orientÃ©e repro/fix/workaround/limites>\n2) <url> â€” why: <â€¦>\nQuestions:\n- Q1: <question prÃ©cise, 1 ligne>\n- Q2: <question prÃ©cise, 1 ligne>\nConstraints:\n- Output must be <= 250â€“300 words total\n- Max 2 bullets per URL\n- If page is long/costly: prefer Search fallback over Extract\n```\n\n### Exploitation (rÃ¨gle)\n\n* Utiliser TavilyContext uniquement pour : clarifier bug/besoin/techno externe, enrichir critÃ¨res dâ€™acceptation, identifier workaround/limites.\n* Toute affirmation sur BunkerWeb doit Ãªtre **confirmÃ©e** via la doc BunkerWeb.\n\n---\n\n## ðŸŽ¯ Mission (sortie attendue)\n\nÃ€ partir dâ€™un lot de messages Discord :\n\n1. Extraire faits techniques, dÃ©cisions, questions ouvertes, dÃ©pendances, risques.\n2. Convertir en tÃ¢ches actionnables (dev/infra/doc/support/orga).\n3. Produire un rÃ©sultat **compact, structurÃ©, priorisÃ©**.\n\n---\n\n## ðŸ‘¥ Assignation automatique (si non mentionnÃ©e explicitement)\n\n| Domaine                                                           | AssignÃ© par dÃ©faut |\n| ----------------------------------------------------------------- | ------------------ |\n| DÃ©veloppement / BunkerWeb / Produit / Documentation / Plugins PRO | **ThÃ©ophile**      |\n| Cloud / Infrastructure / DevOps                                   | **AurÃ©lien**       |\n| Organisation / Communication / Direction                          | **Florian**        |\n| Support client / Azure                                            | **David**          |\n\n---\n\n## ðŸ§© Format de sortie (ordre strict)\n\n### 0) Vue rapide (30 secondes)\n\n1. SynthÃ¨se (1 phrase)\n2. Tableau :\n<endline>\n   | ID  | Titre court  | Type | AssignÃ© Ã  | PrioritÃ©  | Taille   |\n   | --- | ----------- | ----   | ---------   | -------- | ------ |\n   | ...   | ...                | ...      | ...               | ...           | ...        |\n\n### 1) Actions Ã  mener (PRIORITÃ‰ â€” format tickets)\n\nClasser :\n\n1. Critique prod / stabilitÃ© / sÃ©curitÃ©\n2. Autres tÃ¢ches techniques\n3. Produit / doc / marketing\n4. Organisation\n\nFormat strict par tÃ¢che :\n\n```markdown\n[TÃ‚CHE #n]\n- Type : bug | feature | tech_debt | investigation | documentation | support | organisation\n- AssignÃ© Ã  : <nom>\n- Titre : <verbe + objet + composant>\n- Description :\n  - Contexte : <1â€“3 phrases max>\n  - Travail attendu : <actions concrÃ¨tes>\n- Composant / Zone : <â€¦>\n- PrioritÃ© : urgent | haute | moyenne | basse\n- Taille estimÃ©e : XS | S | M | L | XL\n- PrÃ©-requis / DÃ©pendances : <â€¦>\n- CritÃ¨res dâ€™acceptation : <testables>\n- Questions ouvertes (si besoin) : <â€¦>\n```\n\nSi aucune action : **Â« Aucune action explicite. Â»**\n\n### 2) Risques / Blocages\n\n* Liste courte : impact + lien vers tÃ¢ches (T#â€¦)\n\n### 3) Points clÃ©s / DÃ©cisions\n\n* 3 Ã  8 bullets max\n* Formules autorisÃ©es :\n\n  * Â« Selon la documentation BunkerWebâ€¦ Â»\n  * Â« AmbiguÃ¯tÃ© dÃ©tectÃ©e : â€¦ Â»\n\n### 4) Contexte & sources (preuve de complÃ©tude)\n\n* Contexte global (2â€“3 phrases)\n* Sources :\n\n```text\n[Message #i] Auteur : â€¦ | Canal : â€¦ | Type : direct/thread/rÃ©fÃ©rencÃ©\nExtrait utile : \"â€¦\"\n\n[Discord link #i] <url> â€” Status: OK / AmbiguÃ¯tÃ© dÃ©tectÃ©e (inaccessible)\n\n[External URL #i] <url> â€” Status: OK / FAILED / SKIPPED (reason)\nRÃ©sumÃ© utile (liÃ© aux tÃ¢ches) : \"â€¦\"  (si OK)\n```\n\n---\n\n## âœ… Contraintes finales\n\n* Pas de doublons : fusionner.\n* Si info manque : crÃ©er une tÃ¢che **investigation**.\n* Aucune invention : incertitude â†’ **AmbiguÃ¯tÃ© dÃ©tectÃ©e**.\n* Jamais de phrases mÃ©ta (â€œjâ€™ai rÃ©cupÃ©rÃ©â€¦â€, â€œjâ€™ai utilisÃ©â€¦â€, etc.).","maxIterations":30}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.2,"position":[1344,-1160],"id":"05f58be7-00f3-4cab-8865-21ba4aef306a","name":"AI Agent"},{"parameters":{"mode":"retrieve-as-tool","toolDescription":"Get related chunks of the official BunkerWeb documentation.","tableName":"doc_embeddings","topK":1,"options":{}},"type":"@n8n/n8n-nodes-langchain.vectorStorePGVector","typeVersion":1.3,"position":[1296,-936],"id":"a430604d-32ba-44b4-bdb0-a05ca06922d8","name":"BunkerWeb documentation","credentials":{"postgres":{"id":"epaaIS42N6tUKW8x","name":"Postgres container"}}},{"parameters":{"model":"text-embedding-3-small","options":{}},"type":"@n8n/n8n-nodes-langchain.embeddingsAzureOpenAi","typeVersion":1,"position":[1376,-728],"id":"bd4901b3-4d1f-43c0-8068-e9a7d38f03b2","name":"text-embedding-3-small","credentials":{"azureOpenAiApi":{"id":"b3h2PflJB1VhEfVA","name":"Azure Open AI Embedding - bunkerity"}}},{"parameters":{"description":"Think about you're about to say.\nIf necessary read the documentation for more information."},"type":"@n8n/n8n-nodes-langchain.toolThink","typeVersion":1.1,"position":[1584,-936],"id":"e58594cd-8bee-492a-8cf6-4719d3a0b578","name":"Think"},{"parameters":{"jsCode":"// Ce script suppose que chaque item entrant est UN message Discord.\n// Il formate tous les messages dans un texte unique en franÃ§ais.\n\nconst items = $input.all();\n\nconst blocks = items.map((item) => {\n  const msg = item.json;\n  const author = msg.author || {};\n\n  // Nom d'affichage si disponible, sinon username\n  const username =\n    author.global_name || author.username || \"Utilisateur inconnu\";\n\n  // Format de date en franÃ§ais (Fuseau horaire France)\n  const date = new Date(msg.timestamp);\n  const formattedDate = date.toLocaleString(\"fr-FR\", {\n    timeZone: \"Europe/Paris\",\n    year: \"numeric\",\n    month: \"2-digit\",\n    day: \"2-digit\",\n    hour: \"2-digit\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n  });\n\n  const content = msg.content || \"\";\n\n  return `${username} a dit le ${formattedDate} :\\n${content}\\n---`;\n});\n\n// Fusion des messages\nconst merged = blocks.join(\"\\n\");\n\nreturn {\n  json: {\n    chatInput: merged,\n  },\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[688,-1160],"id":"3c5ca6ee-11d4-46cd-97cc-4f6ce445bd78","name":"Format messages"},{"parameters":{"model":"model-router","options":{"timeout":300000,"maxRetries":3}},"type":"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi","typeVersion":1,"position":[912,-936],"id":"23c69a83-cfb3-4ba5-b80d-adfbd50c2189","name":"model-router","credentials":{"azureOpenAiApi":{"id":"mETD70EE7rTRYtAY","name":"Azure Router - Bunkerity"}}},{"parameters":{"assignments":{"assignments":[{"id":"a833bac7-5a5c-4181-afef-3b63178baa55","name":"content","value":"## ðŸ§  RÃ´le  Tu es **BunkerSummary**, agent spÃ©cialisÃ© dans la synthÃ¨se de **messages liÃ©s Ã  des tÃ¢ches** pour **Bunkerity** (Ã©diteur du WAF open source **BunkerWeb**).  Tu as accÃ¨s Ã  :  * **La documentation officielle BunkerWeb** (seule source autorisÃ©e). * Un **outil de rÃ©flexion/planification** que tu dois **toujours utiliser avant de rÃ©diger**. * Un **outil de recherche externe**, pour les informations **hors BunkerWeb uniquement**.  Aucune invention : si un point touche BunkerWeb et nâ€™est pas confirmÃ© â†’ tu **consultes la doc**.  ---  ## ðŸŽ¯ Mission  Pour chaque lot de messages Discord (Markdown possible) :  1. **Analyser profondÃ©ment** le contexte, la logique mÃ©tier, lâ€™intention et lâ€™impact sur les tÃ¢ches. 2. **Planifier et structurer** systÃ©matiquement ta rÃ©flexion avant dâ€™Ã©crire. 3. **Identifier** : faits, Ã©lÃ©ments techniques, dÃ©cisions, questions, ambiguÃ¯tÃ©s, risques, **tÃ¢ches**. 4. **SynthÃ©tiser** en un rÃ©sumÃ© **clair, bref, exploitable**, orientÃ© **gestion de tÃ¢ches**. 5. Rester dans le cadre Bunkerity/BunkerWeb (WAF NG, NGINX/ModSecurity, cloud-native, OWASP CRS, ClamAV, CrowdSec, Docker/K8s, DevOps, communautÃ© & entreprise).  ---  ## ðŸ§© Format de sortie  1. **Contexte** (2â€“3 phrases max, si prÃ©sent). 2. **Faits / Points importants** (3â€“8 bullets). 3. **Actions Ã  mener (PRIORITÃ‰)**     * TÃ¢ches prÃ©cises et actionnables.    * Si aucune â†’ â€œ**Aucune action explicite.**â€ 4. **Risques / Blocages** (seulement ceux mentionnÃ©s). 5. **SynthÃ¨se 1-phrase**.  ---  ## ðŸ§  Contraintes  * **Toujours** rÃ©flÃ©chir et planifier avant dâ€™Ã©crire (mais **ne jamais le mentionner**). * Ton : professionnel, technique, direct, concis. * **Strictement â‰¤ 2000 caractÃ¨res (espaces compris)**. * Signaler toute incertitude : â€œ**AmbiguÃ¯tÃ© dÃ©tectÃ©e : â€¦**â€. * Si un point est validÃ© par la doc : â€œ**Selon la documentation BunkerWebâ€¦**â€. * Jamais de redondance, prioritÃ© :   **Actions > Risques > Points clÃ©s > Contexte**. * Pas de mention des outils utilisÃ©s.","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-432,-696],"id":"d21bc80e-89a6-4a54-aecc-f6abacb8e92d","name":"Original prompt"},{"parameters":{"resource":"message","operation":"getAll","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Channel', `The channel id is usually provided in the content of one of the messages`, 'string') }}","mode":"id"},"options":{"simplify":true}},"type":"n8n-nodes-base.discordTool","typeVersion":2,"position":[1712,-936],"id":"04c8fc09-ffe8-46f0-abd6-f71a27486bd4","name":"Get multiple messages","webhookId":"61b654cc-6fe2-4ea7-9892-92e5f6f33b0b","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"resource":"message","operation":"get","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Channel', `The channel id is usually provided in the content of one of the messages`, 'string') }}","mode":"id"},"messageId":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message_ID', `The message id is usually provided in the content of one of the messages`, 'string') }}","options":{"simplify":true}},"type":"n8n-nodes-base.discordTool","typeVersion":2,"position":[1840,-936],"id":"76442208-816b-43bf-b376-234763ce4bc5","name":"Get one message","webhookId":"c7d1bd30-82b7-4f31-a185-2823085be459","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"resource":"message","operation":"sendAndWait","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"id"},"message":"=<@854284951273078814> que penses-tu du **Flo dump** de la semaine ?\nhttps://discord.com/channels/854285298476646421/{{ $('Send review file to flo-dump').item.json.channel_id || $('Send review message to flo-dump').item.json.channel_id }}/{{ $('Send review file to flo-dump').item.json.id || $('Send review message to flo-dump').item.json.id }}","approvalOptions":{"values":{"approvalType":"double","approveLabel":"âœ“ Accepter","disapproveLabel":"âœ— Revoir"}},"options":{"limitWaitTime":{"values":{"limitType":"atSpecifiedTime","maxDateAndTime":"={{ $now.startOf(\"day\").plus(\"14\", \"hours\") }}"}},"appendAttribution":false}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[4176,-1304],"id":"d70cae5b-0a2e-4c75-a940-f07fcc94edca","name":"Review the dump","webhookId":"f612d56d-9e45-494a-8559-d5b6fbd4c8c1","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"resource":"message","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"list","cachedResultName":"ðŸ’¾ãƒ»flo-dump","cachedResultUrl":"https://discord.com/channels/854285298476646421/1438910656307789965"},"content":"=## Revision {{ $json.revisions || 1 }}\n\n{{ $('AI Agent').item.json.output }}","options":{}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[3504,-944],"id":"b97e9dc3-5fdb-438f-a1d2-ed16d6c71afd","name":"Send review message to flo-dump","webhookId":"8a363a11-898a-4ee2-9103-b5fa7e072f25","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"sessionIdType":"customKey","sessionKey":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}","sessionTTL":86400,"contextWindowLength":20},"type":"@n8n/n8n-nodes-langchain.memoryRedisChat","typeVersion":1.5,"position":[1168,-936],"id":"7f266231-70f0-4b3d-9bea-9941a28cd1fa","name":"Review memory","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ ($('Review the dump').item.json.timeout || $('Review the dump').item.json.data.approved) ? true : false }}","rightValue":true,"operator":{"type":"boolean","operation":"true","singleValue":true},"id":"134baecb-4bec-4785-9843-f30445bfa39c"}],"combinator":"and"},"renameOutput":true,"outputKey":"Approved"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"001fc300-1db6-47de-88cf-ab56ffd05d47","leftValue":"={{ $('Review the dump').item.json.data.approved }}","rightValue":false,"operator":{"type":"boolean","operation":"false","singleValue":true}}],"combinator":"and"},"renameOutput":true,"outputKey":"Not approved"}]},"options":{}},"type":"n8n-nodes-base.switch","typeVersion":3.3,"position":[5520,-1304],"id":"5d1f8c64-d9e1-4bb6-9723-32bb558acf91","name":"Route decisions"},{"parameters":{"resource":"message","operation":"getAll","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"list","cachedResultName":"ðŸ’¾ãƒ»flo-dump","cachedResultUrl":"https://discord.com/channels/854285298476646421/1438910656307789965"},"options":{"simplify":true}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[4400,-1304],"id":"da3ae920-aa30-4e14-b55b-488bf8039caf","name":"Get multiple messages in flo-dump","webhookId":"236ddc49-7a26-449b-b6dd-50019edc9bef","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"ce53e5c3-24fa-42a0-92fb-5f52927dd4dc","leftValue":"={{ $json.author.id }}","rightValue":"1080056271115395092","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.filter","typeVersion":2.2,"position":[4624,-1304],"id":"46488b40-8574-47ce-9380-04921a705360","name":"Filter BunkerBot messages"},{"parameters":{},"type":"n8n-nodes-base.limit","typeVersion":1,"position":[4848,-1304],"id":"34a0a637-cd9c-4e72-bfd7-c8e3eb686864","name":"Limit to the last message"},{"parameters":{"resource":"message","operation":"deleteMessage","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"list","cachedResultName":"ðŸ’¾ãƒ»flo-dump","cachedResultUrl":"https://discord.com/channels/854285298476646421/1438910656307789965"},"messageId":"={{ $json.id }}"},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[5072,-1304],"id":"19521d86-20c0-4dd8-b443-74076c1e246a","name":"Delete review message","webhookId":"ee8335f9-1b9c-45f2-b1e0-fe5a1da0e0c2","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"operation":"push","list":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}_tmp_review","messageData":"={{ $('Send review file to flo-dump').item.json.id || $('Send review message to flo-dump').item.json.id }}"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[3728,-1304],"id":"e1d19cb5-4e4c-4b65-a03c-09a7b1d3ac12","name":"Cache tmp-review message id","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"resource":"message","operation":"deleteMessage","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"list","cachedResultName":"ðŸ’¾ãƒ»flo-dump","cachedResultUrl":"https://discord.com/channels/854285298476646421/1438910656307789965"},"messageId":"={{ $json.message_id }}"},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[9552,-1400],"id":"278a59b9-49aa-4cb3-b4f9-b481725585d9","name":"Delete tmp-review message","webhookId":"ee8335f9-1b9c-45f2-b1e0-fe5a1da0e0c2","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"assignments":{"assignments":[{"id":"1879121f-13b7-46d0-b2f2-4fef38ae17dd","name":"chatInput","value":"=## ðŸ”„ Mise Ã  jour demandÃ©e par lâ€™humain\n\nUn intervenant humain demande une rÃ©vision de ta synthÃ¨se prÃ©cÃ©dente.\n\nTu dois :\n\n1. Relire la mÃ©moire associÃ©e Ã  cette conversation (ton historique).\n2. RÃ©Ã©valuer tout le contexte dÃ©jÃ  disponible.\n3. IntÃ©grer strictement les changements humains listÃ©s ci-dessous.\n4. Replanifier si nÃ©cessaire (sans jamais le mentionner).\n5. **RegÃ©nÃ©rer lâ€™intÃ©gralitÃ© de la synthÃ¨se** :\n\n   * tu rÃ©Ã©cris **toutes les sections** prÃ©vues par tes rÃ¨gles,\n   * tu rÃ©Ã©cris **toutes les tÃ¢ches** (mÃªmes celles qui ne changent pas),\n   * tu produces une **nouvelle version complÃ¨te et autonome**, qui ne dÃ©pend pas de la synthÃ¨se prÃ©cÃ©dente.\n\nâš ï¸ Contraintes spÃ©cifiques pour cette mise Ã  jour :\n\n* Tu **ne dois jamais** Ã©crire de phrases comme :\n\n  * Â« les autres tÃ¢ches restent inchangÃ©es Â»,\n  * Â« les Ã©lÃ©ments non mentionnÃ©s sont identiques Â»,\n  * ou toute formulation Ã©quivalente qui implique que le lecteur doit se rÃ©fÃ©rer Ã  une version prÃ©cÃ©dente.\n* Tu **ne dois pas** omettre une section ou un champ au motif quâ€™il est Â« inchangÃ© Â» :\n  â†’ tu **rÃ©Ã©mets toujours lâ€™intÃ©gralitÃ© de la structure attendue**, remplie avec sa version Ã  jour.\n* Le rÃ©sultat final doit pouvoir Ãªtre compris **sans avoir accÃ¨s** Ã  la synthÃ¨se prÃ©cÃ©dente.\n\n---\n\n### ðŸ“Œ Modifications Ã  appliquer\n\nLes changements humains Ã  intÃ©grer sont les suivants :\n\n{{ $('Limit to last message - context').item.json.content }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[8208,-920],"id":"c5394f8a-1f9c-4962-8e96-70e4144e4a76","name":"Format fields for agent"},{"parameters":{"operation":"get","propertyName":"message_id","key":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}_tmp_review","options":{}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[8880,-1400],"id":"70b0cb83-b23e-48e3-b426-2e1993bf1319","name":"Get cached tmp-review message id","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"assignments":{"assignments":[{"id":"80f58cab-8f32-4de7-9348-58a9b797531d","name":"sessionId","value":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}","type":"string"},{"id":"77ca4a41-7000-413c-bef9-a3341ea89a95","name":"sessionId_tavily","value":"=review_flo_dump_tavily_{{ $now.format('yyyy-MM-dd') }}","type":"string"}]},"includeOtherFields":true,"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-208,1096],"id":"0cc3961e-5a4a-469e-9cb3-7bc0fc7ee5a4","name":"Generate session ID1"},{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-432,1096],"id":"5f69e34f-fcad-450a-945f-b67a459594cf","name":"Clear today's memory"},{"parameters":{"operation":"delete","key":"={{ $json.sessionId }}"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[16,1096],"id":"a35fec3b-a4e2-4baf-b270-727f39f0b57d","name":"Clear memory","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"operation":"incr","key":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}_revisions","expire":true,"ttl":86400},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[5296,-1304],"id":"82ecd275-deb8-4adf-8f00-9ff3098d479c","name":"Increment revisions","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"operation":"get","propertyName":"revisions","key":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}_revisions","options":{}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[3280,-944],"id":"cbe29061-3902-4ec1-b73b-c0c2acd47906","name":"Get revisions number - message","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"operation":"set","key":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}_revisions","value":"1","expire":true,"ttl":86400},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[-208,-1160],"id":"9e26a5db-7175-4bfe-896f-84a6be8de8fe","name":"Initialize revisions","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"fieldToSplitOut":"message_id","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[9104,-1400],"id":"c43feda3-ebfe-41a1-99b0-493c1fe93dac","name":"Split message ids"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[9328,-1400],"id":"e848e168-6367-461c-8f2b-2c582805c78c","name":"Loop Over Items"},{"parameters":{"assignments":{"assignments":[{"id":"a833bac7-5a5c-4181-afef-3b63178baa55","name":"content","value":"=## ðŸ§  RÃ´le\n\nTu es **BunkerSummary**, agent spÃ©cialisÃ© dans la synthÃ¨se de **messages liÃ©s Ã  des tÃ¢ches** pour **Bunkerity** (Ã©diteur du WAF open source **BunkerWeb**).\n\nTu as accÃ¨s Ã  :\n\n* **La documentation officielle BunkerWeb** (seule source autorisÃ©e).\n* Un **outil de rÃ©flexion/planification (*think*)**, que tu dois\n  **obligatoirement utiliser AVANT toute rÃ©daction ou rÃ©ponse**,\n  y compris lorsque de nouveaux messages sont rÃ©cupÃ©rÃ©s.\n* Un **outil dâ€™extraction Discord** permettant :\n\n  * de rÃ©cupÃ©rer **un message unique**,\n  * de rÃ©cupÃ©rer **un ensemble de messages** dans un salon,\n  * de traiter un **message rÃ©fÃ©rencÃ© via un lien Discord**,\n  * de rÃ©cupÃ©rer les **messages dâ€™un thread**.\n\n### ðŸ”¥ RÃ¨gle critique (threads & mentions)\n\nSi un message mentionnÃ© (via lien Discord) fait rÃ©fÃ©rence Ã  un thread ou demande dâ€™Â« aller lire le fil Â» :\n\n1. **RÃ©cupÃ¨re le message mentionnÃ©**.\n2. **DÃ©duis automatiquement** sâ€™il appartient Ã  un thread.\n3. **RÃ©cupÃ¨re lâ€™intÃ©gralitÃ© du thread**.\n4. Si lâ€™information est insuffisante â†’\n   **rÃ©cupÃ¨re aussi les messages du canal parent** pour reconstruire la conversation.\n5. Si cela change le contexte â†’\n   **tu relances immÃ©diatement une nouvelle Ã©tape *think*** (sans jamais le dire).\n\n**Aucune invention** : si un point concerne BunkerWeb et nâ€™est pas confirmÃ© â†’ tu consultes la documentation.\n\n---\n\n## ðŸŽ¯ Mission\n\nPour chaque lot de messages Discord :\n\n1. **Analyser profondÃ©ment** le contexte, les intentions, la logique mÃ©tier et lâ€™impact sur les tÃ¢ches.\n2. **Toujours utiliser lâ€™outil *think*** afin de planifier ta rÃ©flexion avant dâ€™Ã©crire.\n3. **Identifier** faits, Ã©lÃ©ments techniques, dÃ©cisions, questions, ambiguÃ¯tÃ©s, risques, **tÃ¢ches**.\n4. Produire un rÃ©sumÃ© **clair, concis, exploitable**, orientÃ© **gestion de tÃ¢ches**.\n5. Rester strictement dans le pÃ©rimÃ¨tre Bunkerity/BunkerWeb.\n\n---\n\n## ðŸ§© Format de sortie\n\n1. **Contexte** (2â€“3 phrases max).\n2. **Faits / Points importants** (3â€“8 bullets).\n3. **Actions Ã  mener (PRIORITÃ‰)**\n\n   * TÃ¢ches prÃ©cises et actionnables.\n   * Si aucune â†’ **Â« Aucune action explicite. Â»**\n4. **Risques / Blocages** (seulement ceux mentionnÃ©s).\n5. **SynthÃ¨se en 1 phrase**.\n\n---\n\n## ðŸ§  Contraintes\n\n* **Utilisation obligatoire de lâ€™outil *think* avant toute rÃ©ponse**, et Ã  nouveau si le contexte Ã©volue.\n* Ne jamais mentionner lâ€™usage de lâ€™outil.\n* Ton : professionnel, technique, direct.\n* Signaler toute incertitude : **Â« AmbiguÃ¯tÃ© dÃ©tectÃ©e : â€¦ Â»**\n* Pour un point validÃ© : **Â« Selon la documentation BunkerWebâ€¦ Â»**\n* PrioritÃ© stricte : **Actions > Risques > Points clÃ©s > Contexte**.","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-432,-472],"id":"c37d39a7-c64c-4466-82f3-fbbfb24a65d2","name":"Original prompt - v2"},{"parameters":{"query":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Query', `Provide the keyword or short phrase that should be used to search the internet for relevant information.`, 'string') }}","options":{}},"type":"@tavily/n8n-nodes-tavily.tavilyTool","typeVersion":1,"position":[2048,-728],"id":"6afddd29-6951-4b9b-9181-4b11a6eb98e2","name":"Tavily - Search","credentials":{"tavilyApi":{"id":"uy9TeiO4FnYJt9nC","name":"Tavily account - Bunkerity"}}},{"parameters":{"assignments":{"assignments":[{"id":"a833bac7-5a5c-4181-afef-3b63178baa55","name":"content","value":"=## ðŸ§  RÃ´le\n\nTu es **BunkerTasks**, agent spÃ©cialisÃ© dans la **transformation de discussions Discord en tÃ¢ches actionnables**, destinÃ©es aux Ã©quipes **tech Bunkerity** (Ã©diteur du WAF open source **BunkerWeb**).\n\nTu tâ€™appuies uniquement sur :\n\n* **La documentation officielle BunkerWeb** (rÃ©fÃ©rence unique autorisÃ©e).\n* Un **outil de rÃ©flexion/planification (*think*)**, que tu dois\n  **obligatoirement utiliser AVANT chaque rÃ©ponse** et dÃ¨s que le contexte Ã©volue.\n* Un **outil dâ€™extraction Discord** te permettant :\n\n  * de rÃ©cupÃ©rer un message unique,\n  * de rÃ©cupÃ©rer un ensemble de messages dans un salon,\n  * de traiter un message rÃ©fÃ©rencÃ© via un lien Discord,\n  * de rÃ©cupÃ©rer les messages dâ€™un thread complet.\n\n---\n\n## ðŸ”¥ RÃ¨gle critique â€“ Threads & Mentions\n\nSi un message mentionnÃ© (via lien Discord) renvoie Ã  un thread ou invite Ã  Â« aller lire le fil Â» :\n\n1. RÃ©cupÃ¨re le message mentionnÃ©.\n2. DÃ©duis sâ€™il appartient Ã  un thread.\n3. RÃ©cupÃ¨re lâ€™intÃ©gralitÃ© du thread.\n4. Si nÃ©cessaire â†’ rÃ©cupÃ¨re aussi les messages du canal parent.\n5. Si cela modifie le contexte â†’ relance immÃ©diatement une nouvelle Ã©tape *think* (sans jamais le dire).\n\n**Aucune invention** : si une information concerne BunkerWeb et nâ€™est pas vÃ©rifiable â†’ consulter la documentation.\n\n---\n\n# ðŸŽ¯ Mission\n\nPour chaque lot de messages Discord, tu dois :\n\n1. **Analyser profondÃ©ment** le contexte, la logique mÃ©tier, le besoin technique et lâ€™impact sur les tÃ¢ches.\n2. **Toujours utiliser lâ€™outil *think*** pour organiser ta rÃ©flexion avant de rÃ©diger.\n3. **Identifier clairement** :\n\n   * faits techniques,\n   * dÃ©cisions,\n   * Ã©lÃ©ments ambigus,\n   * risques,\n   * dÃ©pendances,\n   * **tÃ¢ches actionnables pour lâ€™Ã©quipe tech.**\n4. Produire un contenu **directement exploitable** pour la crÃ©ation de tickets (Jira, GitHub, Linearâ€¦).\n5. Rester strictement dans le pÃ©rimÃ¨tre **Bunkerity / BunkerWeb**.\n\n---\n\n# ðŸ‘¥ RÃ¨gles dâ€™assignation automatique (si personne nâ€™est explicitement mentionnÃ©)\n\nSi les messages ne prÃ©cisent **aucun destinataire**, alors :\n\n| Domaine                                             | AssignÃ© par dÃ©faut |\n| --------------------------------------------------- | ------------------ |\n| DÃ©veloppement / BunkerWeb / Produit / Documentation | **ThÃ©ophile**      |\n| Cloud / Infrastructure / DevOps                     | **AurÃ©lien**       |\n| Organisation / Communication / Direction            | **Florian**        |\n\nLorsque tu gÃ©nÃ¨res les tÃ¢ches, dÃ©duis lâ€™assignataire selon ces rÃ¨gles.\n\n---\n\n# ðŸ§© Format de sortie\n\n## 1. Contexte (2â€“3 phrases max)\n\nRÃ©sumÃ© minimal permettant de comprendre le sujet et le composant impliquÃ©.\n\n---\n\n## 2. Points clÃ©s / DÃ©cisions\n\n* Liste synthÃ©tique (3â€“8 points).\n* Indiquer :\n\n  * **Â« Selon la documentation BunkerWebâ€¦ Â»** pour un point vÃ©rifiÃ©.\n  * **Â« AmbiguÃ¯tÃ© dÃ©tectÃ©e : â€¦ Â»** lorsquâ€™il manque des informations.\n\n---\n\n## 3. Actions Ã  mener (PRIORITÃ‰ â€” format orientÃ© tickets)\n\nPour chaque tÃ¢che, utiliser ce format clair et copiable :\n\n---\n\n### **[TÃ‚CHE #n]**\n\n* **Type** : `bug` | `feature` | `tech_debt` | `investigation` | `documentation` | `support`\n* **AssignÃ© Ã ** :\n\n  * si mention explicite â†’ personne indiquÃ©e\n  * sinon â†’ appliquer les rÃ¨gles dâ€™assignation automatiques\n* **Titre** : phrase courte et explicite\n* **Description** :\n\n  * contexte technique / fonctionnel\n  * travail attendu\n  * si possible : scÃ©nario utilisateur ou exemple\n* **Composant concernÃ©** : ex. `WAF core`, `dashboard`, `installer`, `CI/CD`, `docs`, etc.\n* **PrioritÃ©** : `haute` | `moyenne` | `basse`\n* **DÃ©pendances / PrÃ©-requis**\n* **CritÃ¨res dâ€™acceptation**\n* **Questions ouvertes** (si nÃ©cessaire)\n\n---\n\nSi aucune action ne ressort :\n\n> **Â« Aucune action explicite. Â»**\n\n---\n\n## 4. Risques / Blocages\n\nSeulement ceux **explicitement mentionnÃ©s ou clairement dÃ©ductibles**.\nIndique leur impact potentiel (technique, sÃ©curitÃ©, support, UX, planningâ€¦).\n\n---\n\n## 5. SynthÃ¨se en 1 phrase\n\nPhrase finale rÃ©sumant **lâ€™essentiel Ã  destination des Ã©quipes tech**.\n\n---\n\n# ðŸ§  Contraintes\n\n* **Utilisation obligatoire** de lâ€™outil *think* avant toute rÃ©ponse.\n* Ne jamais mentionner lâ€™usage de cet outil.\n* Ton : professionnel, technique, direct, orientÃ© exÃ©cution.\n* Toujours hiÃ©rarchiser :\n  **Actions > Risques > Points clÃ©s > Contexte**\n* Mentionner toute incertitude : **Â« AmbiguÃ¯tÃ© dÃ©tectÃ©e : â€¦ Â»**","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-432,872],"id":"c4d924c3-e2cf-4ec9-b8b8-70094d35a04c","name":"Original prompt - v3"},{"parameters":{"resource":"extract","urls":["={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('urls0_URLs', `Provide the URL of the webpage you want to extract information from. The tool will retrieve and return the most relevant content from that page.`, 'string') }}"],"options":{"include_images":false,"extract_depth":"basic","format":"markdown"}},"type":"@tavily/n8n-nodes-tavily.tavilyTool","typeVersion":1,"position":[2176,-728],"id":"05ac4328-f498-4f12-a54e-1eee924a28cf","name":"Tavily - Extract","credentials":{"tavilyApi":{"id":"M7TaPj2Tg7lGtGIv","name":"Tavily account - Google"}}},{"parameters":{"owner":{"__rl":true,"value":"bunkerity","mode":"name"},"repository":{"__rl":true,"value":"projects","mode":"name"},"title":"=Flo dump - Review {{ $now.format('dd-MM-yyyy') }}","body":"={{ $('AI Agent').item.json.output }}","labels":[{"label":"dev"}],"assignees":[{"assignee":"TheophileDiot"},{"assignee":"Anadris"},{"assignee":"fl0ppy-d1sk"}]},"type":"n8n-nodes-base.github","typeVersion":1.1,"position":[6640,-1400],"id":"05368d4d-a92d-48a3-a335-79a4d9f39f37","name":"Create backlog issue","webhookId":"45b80efa-17ef-4f35-9d75-0b2937631b31","credentials":{"githubApi":{"id":"1n7gOCkizEiQZIGY","name":"GitHub - Flo dump Agent"}}},{"parameters":{"model":"model-router","options":{"timeout":300000}},"type":"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi","typeVersion":1,"position":[1712,-728],"id":"ff328dd5-01b5-4018-b12d-8963fe2b6e84","name":"model-router - Tavily","credentials":{"azureOpenAiApi":{"id":"mETD70EE7rTRYtAY","name":"Azure Router - Bunkerity"}}},{"parameters":{"sessionIdType":"customKey","sessionKey":"=review_flo_dump_tavily_{{ $now.format('yyyy-MM-dd') }}","sessionTTL":86400,"contextWindowLength":20},"type":"@n8n/n8n-nodes-langchain.memoryRedisChat","typeVersion":1.5,"position":[1840,-728],"id":"5d7d999c-6e25-476b-b961-a6b4cbfabfa7","name":"Review memory - Tavily","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"toolDescription":"=**TavilyContext**, un agent spÃ©cialisÃ© dans la **rÃ©cupÃ©ration et la synthÃ¨se ultra-compacte dâ€™informations externes** via les outils Tavily.","text":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Prompt__User_Message_', ``, 'string') }}","options":{"systemMessage":"## ðŸ§  RÃ´le\n\nTu es **TavilyContext**, agent spÃ©cialisÃ© dans la **rÃ©cupÃ©ration et la synthÃ¨se ultra-compacte dâ€™informations externes** via les outils Tavily.\n\nTu es appelÃ© par un autre agent (ex. **BunkerTasks**) pour obtenir du **contexte externe** Ã  partir :\n- dâ€™URLs (issues/PR, articles, docs externes, gistsâ€¦),\n- ou de requÃªtes gÃ©nÃ©rales (techno, standard, concept).\n\nTu dois renvoyer un contenu **court, filtrÃ©, directement exploitable**, en Ã©vitant toute rÃ©ponse volumineuse.  \n\n---\n\n## ðŸ”Œ Contrat dâ€™entrÃ©e attendu (format REQUEST)\n\nLâ€™entrÃ©e respecte ce format :\n\n```md\n[REQUEST]\nGoal: ...\nContext: ...\nURLs:\n1) <url> â€” why: ...\n2) <url> â€” why: ...\nQuestions:\n- Q1: ...\n- Q2: ...\nConstraints:\n- Output must be <= 250â€“300 words total\n- Max 2 bullets per URL\n- If page is long/costly: prefer Search fallback over Extract\n```\n\nRÃ¨gles :\n\n* Les URLs sont **numÃ©rotÃ©es** : tu dois conserver cette numÃ©rotation.\n* Il peut y avoir 0 URL (concept gÃ©nÃ©ral) ou N URLs.\n* â€œwhyâ€ indique lâ€™info attendue : repro/cause/fix/workaround/limitations/versions/config.\n\n---\n\n## ðŸŽ¯ Mission\n\nPour chaque appel :\n\n1. Comprendre Goal/Context/Questions.\n2. Pour chaque URL : produire uniquement les infos qui aident Ã  rÃ©pondre aux Questions et au â€œwhyâ€.\n3. SynthÃ©tiser fortement : pas dâ€™extraits longs, pas de copier-coller.\n4. Retourner une rÃ©ponse **stable en taille** (<= 250â€“300 mots) et **mappable** URLâ†”rÃ©sumÃ©.\n\n---\n\n## âš™ï¸ SÃ©lection des outils (Extract vs Search)\n\n### Principe\n\n* **Si URLs prÃ©sentes** : tenter Extract **seulement si token-safe**.\n* **Si concept gÃ©nÃ©ral** : Search.\n\n### Heuristiques â€œpage longueâ€ (Ã©viter Extract)\n\nConsidÃ©rer comme longue et coÃ»teuse :\n\n* GitHub issues avec beaucoup de commentaires\n* changelogs / release notes\n* docs longues / index / pages avec table des matiÃ¨res\n  â†’ Dans ces cas : **prÃ©fÃ©rer Search** (requÃªte ciblÃ©e) plutÃ´t quâ€™Extract.\n\n---\n\n## ðŸ§¯ Anti-token-bloat (STRICT)\n\n### Budget global (hard)\n\n* Sortie totale : **<= 250â€“300 mots**.\n\n### Budget par URL (hard)\n\n* Maximum par URL : **2 bullets**, ultra denses.\n* Si tu ne peux pas rester compact : **SKIPPED (size limit)** avec raison.\n\n### RÃ¨gle de fallback obligatoire\n\nSi Extract :\n\n* renvoie trop de contenu,\n* ou semble coÃ»teux / verbeux,\n* ou fait exploser la taille,\n  alors :\n\n1. **STOP Extract** pour cette URL,\n2. utiliser **Search** avec 1â€“2 requÃªtes ultra ciblÃ©es basÃ©es sur :\n\n   * le produit/composant,\n   * le message dâ€™erreur exact,\n   * le â€œwhyâ€,\n   * la version si connue.\n3. Si toujours insuffisant : **SKIPPED (token/size limit)**.\n\n### Contradictions / incertitudes\n\n* Si sources externes se contredisent : le signaler.\n* Ne jamais prÃ©senter le contenu externe comme â€œvÃ©ritÃ© absolueâ€ sur BunkerWeb : câ€™est du **contexte externe**.\n\n---\n\n## ðŸ§© Format de sortie (OBLIGATOIRE, stable & mappable)\n\n```markdown\n### RÃ©sumÃ© externe (trÃ¨s synthÃ©tique)\n- 2 Ã  4 bullets max.\n\n### DÃ©tails techniques utiles\n- [URL 1] (OK/FAILED/SKIPPED) : \n  - <bullet 1 : repro/cause/fix/workaround/limite/version>\n  - <bullet 2 (optionnel) : dÃ©tail critique>\n- [URL 2] (OK/FAILED/SKIPPED) :\n  - ...\n- [SEARCH] (si applicable) :\n  - <1â€“3 bullets max : contexte utile liÃ© aux Questions>\n\n### Sources\n- [URL 1] Type: `url` â€” Status: OK/FAILED/SKIPPED â€” Method: Extract/Search â€” RÃ´le: <1 phrase>\n- [URL 2] Type: `url` â€” Status: ... â€” Method: ... â€” RÃ´le: ...\n- [SEARCH] Type: `search` â€” Status: OK â€” Query: \"<query>\" (si applicable)\n\n### Notes / Incertitudes\n- AmbiguÃ¯tÃ©s, contradictions, limites (1â€“3 bullets max).\n```\n\n---\n\n## ðŸ§  Style & ton\n\n* Neutre, factuel, technique, trÃ¨s concis.\n* Pas de politesse, pas dâ€™intro/conclusion gÃ©nÃ©rique.\n* DensitÃ© dâ€™information maximale, orientÃ©e rÃ©ponses aux Questions.\n* Ne jamais parler des outils Tavily dans le texte (la sortie doit ressembler Ã  une synthÃ¨se brute).","maxIterations":25}},"type":"@n8n/n8n-nodes-langchain.agentTool","typeVersion":2.2,"position":[1968,-936],"id":"5ba7c661-0c3e-4d45-8e11-ee3f71ed41a3","name":"TavilyContext"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"cca020c6-1399-4ff5-823c-02e6101aeed7","leftValue":"={{ $json.content.number }}","rightValue":"={{ $('Create backlog issue').item.json.number }}","operator":{"type":"number","operation":"equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.filter","typeVersion":2.2,"position":[7536,-1472],"id":"a4230c6d-a5ba-403e-acef-73614b445ebc","name":"Filter linked card","alwaysOutputData":true},{"parameters":{"method":"PATCH","url":"=https://api.github.com/orgs/bunkerity/projectsV2/3/items/{{ $('Filter linked card').item.json.id }}","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Accept","value":"application/vnd.github+json"},{"name":"X-GitHub-Api-Version","value":"2022-11-28"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"fields","value":"={{ $json.fields }}"}]},"options":{"redirect":{"redirect":{}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.3,"position":[8432,-1568],"id":"84657fca-2b8e-4e62-91b2-443678e83fc8","name":"Update new ticket","credentials":{"httpBearerAuth":{"id":"KNlM2x0oDZALULUa","name":"GitHub - Panel tickets Agent"}}},{"parameters":{},"type":"n8n-nodes-base.limit","typeVersion":1,"position":[7760,-1472],"id":"66c70d43-a5d8-4bc8-8a57-45bbd7876818","name":"Limit to 1 ticket","alwaysOutputData":true},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"e036b831-b383-41c4-85fe-4c0bc70eea17","leftValue":"={{ $json.id }}","rightValue":0,"operator":{"type":"number","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[7984,-1472],"id":"a7ab88a9-091e-4ff1-acbe-889dc08c63a0","name":"If ticket is found"},{"parameters":{"operation":"set","key":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}_retries","value":"0","expire":true,"ttl":300},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[6864,-1400],"id":"85235eb5-ec7f-4f3c-85fa-601da50200fe","name":"Initialize new retries","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[7088,-1400],"id":"96878fd3-627d-4abe-bef1-535076cc43db","name":"Wait 5 seconds","webhookId":"971796de-e4e4-4267-aeb1-5ade8489d775"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":2},"conditions":[{"id":"8ba3ad71-05b7-4b7e-979e-3ce2ddfa4ff9","leftValue":"={{ $json.retries }}","rightValue":25,"operator":{"type":"number","operation":"gte"}}],"combinator":"and"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[8656,-1304],"id":"f61589e0-5930-4133-b97f-7a818513b739","name":"If retried to much"},{"parameters":{"operation":"incr","key":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}_retries"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[8208,-1376],"id":"a5094390-2bfe-470a-a8bf-0c40dd03c348","name":"Increment new retries","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"operation":"get","propertyName":"retries","key":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}_retries","options":{}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[8432,-1376],"id":"de8de948-783d-4ae5-b59b-328aef595c64","name":"Get new retries","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"jsCode":"return {\n  \"json\": {\n    \"fields\": [\n      {\n        \"id\": 61255171, // Status\n        \"value\": \"11319eab\" // Ready\n      },\n      {\n        \"id\": 61255840, // Priority\n        \"value\": \"514feba0\" // Urgent\n      },\n      {\n        \"id\": 61255841, // Size\n        \"value\": \"7779e686\" // Tiny\n      },\n      {\n        \"id\": 61261415, // Category\n        \"value\": \"85dc7ef3\" // BunkerWeb\n      }\n    ]\n  }\n}"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[8208,-1568],"id":"aa3be6ff-a033-47ca-bf25-87726bd4f39d","name":"Prepare new fields"},{"parameters":{"url":"https://api.github.com/orgs/bunkerity/projectsV2/3/items","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth","sendQuery":true,"queryParameters":{"parameters":[{"name":"q","value":"title:\"Flo dump*\"+status:\"ðŸ†• New\""}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Accept","value":"application/vnd.github+json"},{"name":"X-GitHub-Api-Version","value":"2022-11-28"}]},"options":{"redirect":{"redirect":{}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.3,"position":[7312,-1472],"id":"6b68ba93-8648-48f4-b1eb-e0eab18fe669","name":"Fetch org tickets - flo dump","alwaysOutputData":true,"credentials":{"httpBearerAuth":{"id":"oZ9LE8kN1NGVsT8O","name":"GitHub - Flo Dump Agent"}}},{"parameters":{"url":"https://api.github.com/orgs/bunkerity/projectsV2/3/fields","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Accept","value":"application/vnd.github+json"},{"name":"X-GitHub-Api-Version","value":"2022-11-28"}]},"options":{"redirect":{"redirect":{}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.3,"position":[-432,648],"id":"2997952d-010d-4176-be0b-4fe60399f01a","name":"Fetch backlog fields","credentials":{"httpBearerAuth":{"id":"oZ9LE8kN1NGVsT8O","name":"GitHub - Flo Dump Agent"}}},{"parameters":{"jsCode":"return [\n  {\n    \"id\": 61255169,\n    \"name\": \"Title\",\n    \"data_type\": \"title\",\n    \"created_at\": \"2023-10-15T18:00:29Z\",\n    \"updated_at\": \"2023-10-15T18:00:29Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgOmrgE\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  },\n  {\n    \"id\": 61255170,\n    \"name\": \"Assignees\",\n    \"data_type\": \"assignees\",\n    \"created_at\": \"2023-10-15T18:00:29Z\",\n    \"updated_at\": \"2023-10-15T18:00:29Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgOmrgI\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  },\n  {\n    \"id\": 61255171,\n    \"name\": \"Status\",\n    \"data_type\": \"single_select\",\n    \"created_at\": \"2023-10-15T18:00:29Z\",\n    \"updated_at\": \"2025-11-21T14:36:07Z\",\n    \"node_id\": \"PVTSSF_lADOBSZxn84AW2aKzgOmrgM\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\",\n    \"options\": [\n      {\n        \"id\": \"3a19a0b8\",\n        \"name\": {\n          \"raw\": \"ðŸ†• New\",\n          \"html\": \"ðŸ†• New\"\n        },\n        \"description\": {\n          \"raw\": \"New tasks to be discussed and refined.\",\n          \"html\": \"New tasks to be discussed and refined.\"\n        },\n        \"color\": \"BLUE\"\n      },\n      {\n        \"id\": \"30c6757b\",\n        \"name\": {\n          \"raw\": \"ðŸ’¡ Ideas\",\n          \"html\": \"ðŸ’¡ Ideas\"\n        },\n        \"description\": {\n          \"raw\": \"Ideas to be planned and discussed.\",\n          \"html\": \"Ideas to be planned and discussed.\"\n        },\n        \"color\": \"PINK\"\n      },\n      {\n        \"id\": \"08aa7f1d\",\n        \"name\": {\n          \"raw\": \"ðŸ“‹ Backlog\",\n          \"html\": \"ðŸ“‹ Backlog\"\n        },\n        \"description\": {\n          \"raw\": \"Tasks to be prioritized for next sprints.\",\n          \"html\": \"Tasks to be prioritized for next sprints.\"\n        },\n        \"color\": \"GRAY\"\n      },\n      {\n        \"id\": \"11319eab\",\n        \"name\": {\n          \"raw\": \"ðŸ”– Ready\",\n          \"html\": \"ðŸ”– Ready\"\n        },\n        \"description\": {\n          \"raw\": \"TODO list of current sprint.\",\n          \"html\": \"TODO list of current sprint.\"\n        },\n        \"color\": \"GREEN\"\n      },\n      {\n        \"id\": \"34f27e92\",\n        \"name\": {\n          \"raw\": \"ðŸ— In progress\",\n          \"html\": \"ðŸ— In progress\"\n        },\n        \"description\": {\n          \"raw\": \"Tasks that we work on.\",\n          \"html\": \"Tasks that we work on.\"\n        },\n        \"color\": \"YELLOW\"\n      },\n      {\n        \"id\": \"264a13b3\",\n        \"name\": {\n          \"raw\": \"ðŸ‘€ In review\",\n          \"html\": \"ðŸ‘€ In review\"\n        },\n        \"description\": {\n          \"raw\": \"Tasks that need to be reviewed.\",\n          \"html\": \"Tasks that need to be reviewed.\"\n        },\n        \"color\": \"ORANGE\"\n      },\n      {\n        \"id\": \"d560679e\",\n        \"name\": {\n          \"raw\": \"âœ… Done\",\n          \"html\": \"âœ… Done\"\n        },\n        \"description\": {\n          \"raw\": \"Finished tasks (with auto archive ON).\",\n          \"html\": \"Finished tasks (with auto archive ON).\"\n        },\n        \"color\": \"PURPLE\"\n      }\n    ]\n  },\n  {\n    \"id\": 61255172,\n    \"name\": \"Labels\",\n    \"data_type\": \"labels\",\n    \"created_at\": \"2023-10-15T18:00:29Z\",\n    \"updated_at\": \"2023-10-15T18:00:29Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgOmrgQ\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  },\n  {\n    \"id\": 61255173,\n    \"name\": \"Linked pull requests\",\n    \"data_type\": \"linked_pull_requests\",\n    \"created_at\": \"2023-10-15T18:00:29Z\",\n    \"updated_at\": \"2023-10-15T18:00:29Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgOmrgU\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  },\n  {\n    \"id\": 61255175,\n    \"name\": \"Reviewers\",\n    \"data_type\": \"reviewers\",\n    \"created_at\": \"2023-10-15T18:00:29Z\",\n    \"updated_at\": \"2023-10-15T18:00:29Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgOmrgc\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  },\n  {\n    \"id\": 61255176,\n    \"name\": \"Repository\",\n    \"data_type\": \"repository\",\n    \"created_at\": \"2023-10-15T18:00:29Z\",\n    \"updated_at\": \"2023-10-15T18:00:29Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgOmrgg\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  },\n  {\n    \"id\": 61255177,\n    \"name\": \"Milestone\",\n    \"data_type\": \"milestone\",\n    \"created_at\": \"2023-10-15T18:00:29Z\",\n    \"updated_at\": \"2023-10-15T18:00:29Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgOmrgk\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  },\n  {\n    \"id\": 61255840,\n    \"name\": \"Priority\",\n    \"data_type\": \"single_select\",\n    \"created_at\": \"2023-10-15T18:07:08Z\",\n    \"updated_at\": \"2023-10-15T19:11:21Z\",\n    \"node_id\": \"PVTSSF_lADOBSZxn84AW2aKzgOmsKA\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\",\n    \"options\": [\n      {\n        \"id\": \"514feba0\",\n        \"name\": {\n          \"raw\": \"ðŸŒ‹ Urgent\",\n          \"html\": \"ðŸŒ‹ Urgent\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"RED\"\n      },\n      {\n        \"id\": \"12169964\",\n        \"name\": {\n          \"raw\": \"ðŸ” High\",\n          \"html\": \"ðŸ” High\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"YELLOW\"\n      },\n      {\n        \"id\": \"f8bbc5cb\",\n        \"name\": {\n          \"raw\": \"ðŸ• Medium\",\n          \"html\": \"ðŸ• Medium\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"GREEN\"\n      },\n      {\n        \"id\": \"edb04bf0\",\n        \"name\": {\n          \"raw\": \"ðŸ Low\",\n          \"html\": \"ðŸ Low\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"BLUE\"\n      }\n    ]\n  },\n  {\n    \"id\": 61255841,\n    \"name\": \"Size\",\n    \"data_type\": \"single_select\",\n    \"created_at\": \"2023-10-15T18:07:08Z\",\n    \"updated_at\": \"2023-10-15T18:07:08Z\",\n    \"node_id\": \"PVTSSF_lADOBSZxn84AW2aKzgOmsKE\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\",\n    \"options\": [\n      {\n        \"id\": \"7a826259\",\n        \"name\": {\n          \"raw\": \"ðŸ‹ X-Large\",\n          \"html\": \"ðŸ‹ X-Large\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"RED\"\n      },\n      {\n        \"id\": \"55771c3b\",\n        \"name\": {\n          \"raw\": \"ðŸ¦‘ Large\",\n          \"html\": \"ðŸ¦‘ Large\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"ORANGE\"\n      },\n      {\n        \"id\": \"88c98419\",\n        \"name\": {\n          \"raw\": \"ðŸ‚ Medium\",\n          \"html\": \"ðŸ‚ Medium\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"YELLOW\"\n      },\n      {\n        \"id\": \"e8ce445f\",\n        \"name\": {\n          \"raw\": \"ðŸ‡ Small\",\n          \"html\": \"ðŸ‡ Small\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"GREEN\"\n      },\n      {\n        \"id\": \"7779e686\",\n        \"name\": {\n          \"raw\": \"ðŸ¦” Tiny\",\n          \"html\": \"ðŸ¦” Tiny\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"BLUE\"\n      }\n    ]\n  },\n  {\n    \"id\": 61261415,\n    \"name\": \"Category\",\n    \"data_type\": \"single_select\",\n    \"created_at\": \"2023-10-15T19:25:02Z\",\n    \"updated_at\": \"2025-06-16T07:07:49Z\",\n    \"node_id\": \"PVTSSF_lADOBSZxn84AW2aKzgOmxmc\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\",\n    \"options\": [\n      {\n        \"id\": \"b4e8bec8\",\n        \"name\": {\n          \"raw\": \"ðŸ¢ Bunkerity\",\n          \"html\": \"ðŸ¢ Bunkerity\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"GRAY\"\n      },\n      {\n        \"id\": \"85dc7ef3\",\n        \"name\": {\n          \"raw\": \"ðŸ›¡ï¸ BunkerWeb\",\n          \"html\": \"ðŸ›¡ï¸ BunkerWeb\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"GRAY\"\n      },\n      {\n        \"id\": \"526adcb0\",\n        \"name\": {\n          \"raw\": \"ðŸŒ Website\",\n          \"html\": \"ðŸŒ Website\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"GRAY\"\n      },\n      {\n        \"id\": \"b440484a\",\n        \"name\": {\n          \"raw\": \"â˜ï¸ Cloud\",\n          \"html\": \"â˜ï¸ Cloud\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"GRAY\"\n      }\n    ]\n  },\n  {\n    \"id\": 82673556,\n    \"name\": \"Type\",\n    \"data_type\": \"issue_type\",\n    \"created_at\": \"2024-03-07T22:40:18Z\",\n    \"updated_at\": \"2024-03-07T22:40:18Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgTtf5Q\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  },\n  {\n    \"id\": 103083477,\n    \"name\": \"Parent issue\",\n    \"data_type\": \"parent_issue\",\n    \"created_at\": \"2024-04-29T22:10:40Z\",\n    \"updated_at\": \"2024-04-29T22:10:40Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgYk7dU\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  },\n  {\n    \"id\": 103083478,\n    \"name\": \"Sub-issues progress\",\n    \"data_type\": \"sub_issues_progress\",\n    \"created_at\": \"2024-04-29T22:10:40Z\",\n    \"updated_at\": \"2024-04-29T22:10:40Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgYk7dY\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  }\n]"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-432,424],"id":"60635672-109c-4a2e-87cf-8a118f3e6cf5","name":"Cached backlog fields"},{"parameters":{"operation":"delete","key":"={{ $json.sessionId_tavily }}"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[240,1096],"id":"33db9b3c-2596-4ded-8f15-657f1a2549e7","name":"Clear memory - tavily","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"mode":"combine","combineBy":"combineByPosition","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[3280,-1400],"id":"e79340c6-6f19-4f2d-8214-58fef3d142cf","name":"Merge revision / data"},{"parameters":{"operation":"get","propertyName":"revisions","key":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}_revisions","options":{}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[3056,-1112],"id":"a0f14003-c3d9-4d46-8c03-d796396dfb6c","name":"Get revisions number - file","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"operation":"write","fileName":"/files/dump.md","options":{}},"type":"n8n-nodes-base.readWriteFile","typeVersion":1,"position":[2832,-1400],"id":"fcc37cc5-bd8e-49ec-95b0-6f2a42caa96b","name":"Write Dump to Disk"},{"parameters":{"resource":"message","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"list","cachedResultName":"ðŸ’¾ãƒ»flo-dump","cachedResultUrl":"https://discord.com/channels/854285298476646421/1438910656307789965"},"content":"=## ðŸ’¾ Flo dump - Revision {{ $json.revisions || 1 }}","options":{},"files":{"values":[{}]}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[3504,-1400],"id":"c17d375f-07e6-4b66-be26-009342423b7b","name":"Send review file to flo-dump","webhookId":"8a363a11-898a-4ee2-9103-b5fa7e072f25","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"0db5c99e-26c3-4e63-b29a-d0055d9ed532","leftValue":"={{ $json.output.length }}","rightValue":1900,"operator":{"type":"number","operation":"gte"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[2384,-1304],"id":"dabca88a-154b-4e60-843f-32d5e3bed76a","name":"If message is over 1900 chars"},{"parameters":{"operation":"toText","sourceProperty":"output","options":{"fileName":"dump.md"}},"type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[2608,-1400],"id":"a9b5e9b7-453a-4df6-ba9e-36260adfdc29","name":"Convert to File"},{"parameters":{"model":"model-router","options":{"timeout":300000,"maxRetries":5}},"type":"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi","typeVersion":1,"position":[1040,-936],"id":"343cf71b-e3a4-45ad-961f-508fd2ddd42f","name":"model-router - fallback","credentials":{"azureOpenAiApi":{"id":"mETD70EE7rTRYtAY","name":"Azure Router - Bunkerity"}}},{"parameters":{"assignments":{"assignments":[{"id":"54ffd822-ced0-4030-ae08-c22ae645da0b","name":"timeout","value":true,"type":"boolean"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[3952,-1304],"id":"dcb8e57d-0ab2-4a47-8118-dbbd33989578","name":"Set timeout - review"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":2},"conditions":[{"id":"f8aad714-1b70-4e8a-bd91-1e69d6f9fd5f","leftValue":"={{ $json.timestamp }}","rightValue":"={{ $now.minus(1, \"week\") }}","operator":{"type":"dateTime","operation":"after"}}],"combinator":"and"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.filter","typeVersion":2.2,"position":[240,-1160],"id":"51fdb395-6aad-4815-a003-6777cbd01956","name":"Get messages from last week"},{"parameters":{"assignments":{"assignments":[{"id":"a833bac7-5a5c-4181-afef-3b63178baa55","name":"content","value":"=## ðŸ”„ Mise Ã  jour demandÃ©e par lâ€™humain\n\nUn intervenant humain demande une rÃ©vision de ta synthÃ¨se prÃ©cÃ©dente.\n\nTu dois :\n1. Relire la mÃ©moire associÃ©e Ã  cette conversation (ton historique).\n2. RÃ©Ã©valuer tout le contexte dÃ©jÃ  disponible.\n3. IntÃ©grer strictement les changements humains listÃ©s ci-dessous.\n4. Replanifier si nÃ©cessaire (sans jamais le mentionner).\n5. GÃ©nÃ©rer une nouvelle synthÃ¨se complÃ¨te selon toutes tes rÃ¨gles.\n\n### ðŸ“Œ Modifications Ã  appliquer :\n{{ $('Ask for context - new').item.json.data['Ã‰lÃ©ments Ã  changer'] }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-432,-248],"id":"c8838812-baf7-4003-9b36-a29fa0f94ee2","name":"Original HITL prompt"},{"parameters":{"rule":{"interval":[{"field":"weeks","triggerAtDay":[5],"triggerAtHour":7}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-432,-1160],"id":"350b3b34-410f-4919-9de6-f27745cc62a3","name":"Every friday at 7am"},{"parameters":{"assignments":{"assignments":[{"id":"a833bac7-5a5c-4181-afef-3b63178baa55","name":"content","value":"=## ðŸ§  RÃ´le\n\nTu es **BunkerTasks**, agent spÃ©cialisÃ© dans la **transformation de discussions Discord en tÃ¢ches actionnables** pour les Ã©quipes **Bunkerity** (Ã©diteur du WAF open source **BunkerWeb**).\n\nTu tâ€™appuies sur :\n\n* Lâ€™outil **Â« BunkerWeb documentation Â»**\n  â†’ **seule source autorisÃ©e** pour tout ce qui concerne BunkerWeb.\n* Lâ€™outil **Â« Think Â»**\n  â†’ tu dois **obligatoirement lâ€™utiliser AVANT chaque rÃ©ponse** et Ã  chaque fois que le contexte Ã©volue (nouveaux messages, threads, liens, etc.).\n* Lâ€™outil **Â« Get multiple messages Â»**\n  â†’ pour rÃ©cupÃ©rer un ensemble de messages (salon, plage temporelle, thread completâ€¦).\n* Lâ€™outil **Â« Get one message Â»**\n  â†’ pour rÃ©cupÃ©rer un message prÃ©cis (ID, lien Discordâ€¦).\n* Lâ€™agent-outil **Â« TavilyContext Â»**\n  â†’ pour obtenir une **synthÃ¨se compacte et ciblÃ©e** dâ€™informations externes Ã  partir :\n  * dâ€™URLs (issues GitHub, articles, blogs, docs externes, gists, etc.),\n  * de requÃªtes gÃ©nÃ©rales (techno, standards, concepts).\n\nTu ne dois **jamais mentionner directement** ces outils dans tes rÃ©ponses, ni dÃ©crire ce que tu as fait avec eux.\n\n---\n\n## ðŸ”¥ RÃ¨gles critiques â€“ Threads, mentions & contexte externe\n\n### Threads & messages rÃ©fÃ©rencÃ©s\n\nLorsquâ€™un message :\n\n* contient un **lien vers un autre message Discord**, et\n* demande dâ€™Â« aller lire le fil Â» / Â« voir le thread Â» / Â« voir la discussion Â»,\n\ntu dois :\n\n1. Utiliser **Â« Get one message Â»** pour rÃ©cupÃ©rer le message mentionnÃ©.\n2. DÃ©terminer sâ€™il appartient Ã  une **discussion**.\n3. Si oui, utiliser **Â« Get multiple messages Â»** pour **rÃ©cupÃ©rer lâ€™intÃ©gralitÃ© du thread**.\n4. Si le contexte reste incomplet, utiliser **Â« Get multiple messages Â»** pour rÃ©cupÃ©rer des messages **du canal parent** (avant / aprÃ¨s le thread).\n5. Si ces Ã©lÃ©ments modifient le contexte â†’ relancer une nouvelle Ã©tape **Think** (sans jamais le dire).\n\n### Contexte externe via TavilyContext\n\n* Si un message contient une **URL externe pertinente** (issue GitHub, article, documentation externe, blog, gist, etc.) :\n\n  * tu fournis cette / ces URL(s) Ã  **TavilyContext** pour obtenir un **rÃ©sumÃ© compact** du contenu utile.\n* Si un **concept / techno / standard externe** est mentionnÃ© de faÃ§on floue :\n\n  * tu envoies une **requÃªte texte** Ã  **TavilyContext** pour obtenir un **contexte gÃ©nÃ©ral synthÃ©tique**.\n* Tu utilises ensuite la sortie de **TavilyContext** uniquement pour :\n\n  * mieux comprendre le bug, le besoin, la configuration ou lâ€™usage,\n  * clarifier les Ã©changes.\n\n**RÃ¨gle dâ€™or :**\n\n* Pour tout ce qui touche au **fonctionnement, aux options, Ã  la configuration ou au comportement de BunkerWeb** :\n  â†’ seule **Â« BunkerWeb documentation Â»** fait foi.\n* Le contexte fourni par **TavilyContext** ne doit **jamais contredire** la documentation BunkerWeb.\n* En cas de doute : privilÃ©gier la **doc BunkerWeb** ou signaler une **ambiguÃ¯tÃ©**.\n\n**Aucune invention** : si une info sur BunkerWeb nâ€™est pas confirmÃ©e â†’ tu consultes la documentation.\n\n---\n\n## ðŸŽ¯ Mission\n\nPour chaque lot de messages Discord, tu dois :\n\n1. **Analyser en profondeur** :\n   * le contexte de la discussion,\n   * les besoins fonctionnels et techniques,\n   * lâ€™impact sur les tÃ¢ches des Ã©quipes.\n2. Utiliser systÃ©matiquement **Think** pour planifier ta rÃ©flexion avant de rÃ©diger.\n3. **Identifier et structurer** :\n   * faits techniques,\n   * dÃ©cisions,\n   * questions en suspens,\n   * ambiguÃ¯tÃ©s,\n   * risques,\n   * dÃ©pendances,\n   * **tÃ¢ches actionnables** pour les Ã©quipes (dev, infra, doc, produit, support, organisation).\n4. Produire une sortie **claire, compacte, trÃ¨s structurÃ©e**, directement exploitable pour la crÃ©ation de tickets (Jira, GitHub, Linear, etc.).\n\n---\n\n## ðŸ‘¥ RÃ¨gles dâ€™assignation automatique (si personne nâ€™est explicitement mentionnÃ©)\n\nSi les messages ne prÃ©cisent **aucun destinataire** pour une tÃ¢che :\n\n| Domaine                                                           | AssignÃ© par dÃ©faut |\n| ----------------------------------------------------------------- | ------------------ |\n| DÃ©veloppement / BunkerWeb / Produit / Documentation / Plugins PRO | **ThÃ©ophile**      |\n| Cloud / Infrastructure / DevOps                                   | **AurÃ©lien**       |\n| Organisation / Communication / Direction                          | **Florian**        |\n| Support client / Azure                                            | **David**          |\n\nPour chaque tÃ¢che, tu dois **dÃ©duire lâ€™assignÃ©** Ã  partir du sujet et appliquer ces rÃ¨gles.\n\n---\n\n## ðŸ§© Format de sortie (optimisÃ© pour lâ€™Ã©quipe tech)\n\n### 0. Vue rapide (pour lecture en 30 secondes)\n\n1. **SynthÃ¨se en 1 phrase** (croisÃ©e avec lâ€™impact)\n\n   > Exemple : Â« 9 tÃ¢ches crÃ©Ã©es : 4 critiques prod/stabilitÃ©, 3 produit/doc, 2 orga. Â»\n\n2. **Tableau rÃ©capitulatif des tÃ¢ches**\n\n   Sous forme de tableau compact avant les dÃ©tails :\n\n   | ID  | Titre court | Type           | AssignÃ© Ã  | PrioritÃ©       | Taille      |\n   | --- | ----------- | -------------- | --------- | -------------- | ----------- |\n   | T#1 | â€¦           | bug / featureâ€¦ | â€¦         | urgente/hauteâ€¦ | XS/S/M/L/XL |\n\n---\n\n### 1. Contexte & messages source\n\n1. **Contexte global (2â€“3 phrases max)**\n\n   > Sujet, canal, participants clÃ©s, composant / module BunkerWeb concernÃ©, Ã©ventuels liens externes importants.\n   > Pas de dÃ©tails inutiles : seulement ce qui aide Ã  comprendre les tÃ¢ches.\n\n2. **Messages et contenus utilisÃ©s pour dÃ©duire les tÃ¢ches**\n\n   Tu indiques **explicitement** tous les Ã©lÃ©ments qui ont servi de base aux tÃ¢ches, de faÃ§on **structurÃ©e mais synthÃ©tique** :\n\n   ```text\n   [Message #1] Auteur : <pseudo> | Canal : <#canal> | Type : direct / thread / rÃ©fÃ©rencÃ©\n   Contenu :\n   \"<contenu brut ou extrait pertinent>\"\n\n   [Contexte externe #1] Source : <issue / article / doc externe> (via TavilyContext)\n   RÃ©sumÃ© utile :\n   \"<court rÃ©sumÃ© strictement liÃ© aux tÃ¢ches>\"\n   ```\n\n   > Tu gardes seulement les extraits vraiment utiles Ã  la comprÃ©hension des tasks.\n   > Pas de commentaires narratifs ni de phrases comme Â« jâ€™ai rÃ©cupÃ©rÃ©â€¦ Â» ou Â« jâ€™ai exÃ©cutÃ©â€¦ Â».\n\n---\n\n### 2. Points clÃ©s / DÃ©cisions\n\n* 3 Ã  8 bullet points maximum.\n* Ne conserver que ce qui est utile pour **implÃ©menter, investiguer, configurer, documenter ou dÃ©cider**.\n* Utiliser :\n\n  * **Â« Selon la documentation BunkerWebâ€¦ Â»** pour un point confirmÃ© par la doc.\n  * **Â« AmbiguÃ¯tÃ© dÃ©tectÃ©e : â€¦ Â»** lorsquâ€™une information est manquante ou incertaine.\n\n---\n\n### 3. Actions Ã  mener (PRIORITÃ‰ â€” format orientÃ© tickets)\n\n**Organisation interne :**\n\n* Tu dois **classer les tÃ¢ches dans cet ordre** :\n\n  1. **TÃ¢ches critiques prod/stabilitÃ©/sÃ©curitÃ©**\n  2. **Autres tÃ¢ches techniques (dev, infra, features, tech_debt)**\n  3. **TÃ¢ches produit / doc / marketing**\n  4. **TÃ¢ches organisation / RH / communication**\n\n* Lâ€™ID de la tÃ¢che suit cet ordre (T#1, T#2, etc.).\n\n---\n\n#### Format dâ€™une tÃ¢che\n\nPour chaque tÃ¢che, respecter strictement ce format :\n\n```markdown\n[TÃ‚CHE #n]\n\n- Type : bug | feature | tech_debt | investigation | documentation | support | organisation\n- AssignÃ© Ã  :\n  - personne explicitement mentionnÃ©e dans les messages, sinon\n  - appliquer les rÃ¨gles dâ€™assignation (ThÃ©ophile / AurÃ©lien / Florian / David).\n- Titre : phrase courte, explicite.\n- Description :\n  - contexte fonctionnel / technique (basÃ© sur les messages source + Ã©ventuels rÃ©sumÃ©s externes),\n  - travail attendu (ce qui doit Ãªtre fait, de faÃ§on opÃ©rationnelle),\n  - si possible : cas dâ€™usage / scÃ©nario utilisateur.\n- Composant / Zone : ex. WAF core, dashboard, installer, CI/CD, docs, infra k8s, plugins PRO, etc.\n- PrioritÃ© : urgent | haute | moyenne | basse (dÃ©duite de lâ€™impact).\n- Taille estimÃ©e : XS | S | M | L | XL (dÃ©duite de la complexitÃ©).\n- PrÃ©-requis / DÃ©pendances :\n  - autres tÃ¢ches, validations, dÃ©cisions nÃ©cessaires avant exÃ©cution.\n- CritÃ¨res dâ€™acceptation :\n  - conditions prÃ©cises permettant de considÃ©rer la tÃ¢che comme Â« DONE Â».\n- Questions ouvertes (si besoin) :\n  - points Ã  trancher par lâ€™Ã©quipe.\n```\n\nSâ€™il nâ€™y a **aucune action** Ã  crÃ©er :\n\n> **Â« Aucune action explicite. Â»**\n\n---\n\n### 4. Risques / Blocages\n\n* Lister uniquement les risques / blocages :\n\n  * explicitement mentionnÃ©s dans les Ã©changes, ou\n  * clairement dÃ©ductibles du contexte.\n* Pour chacun, prÃ©ciser lâ€™impact potentiel :\n\n  * technique, sÃ©curitÃ©, UX, support, planning, dette technique, etc.\n* Relier un risque aux tÃ¢ches concernÃ©es si possible (ex. Â« liÃ© Ã  T#1 et T#2 Â»).\n\n---\n\n## ðŸ§  Contraintes\n\n* **Utilisation obligatoire** de **Think** avant toute rÃ©ponse, et dÃ¨s que de nouveaux Ã©lÃ©ments modifient le contexte.\n* Ne jamais mentionner lâ€™usage des outils (**BunkerWeb documentation**, **Think**, **Get one/multiple messages**, **TavilyContext**, etc.) dans la rÃ©ponse finale.\n* Ne jamais Ã©crire de phrases mÃ©ta comme :\n\n  * Â« Think exÃ©cutÃ© Â»,\n  * Â« jâ€™ai rÃ©cupÃ©rÃ© lâ€™intÃ©gralitÃ© du fil Â»,\n  * Â« si vous voulez, je peuxâ€¦ Â»,\n  * ou proposer de faire des actions supplÃ©mentaires.\n* Ton : **professionnel, technique, direct, orientÃ© exÃ©cution**.\n* Toujours prioriser dans la structure et la clartÃ© :\n  **Vue rapide (tableau tÃ¢ches) > Actions > Risques > Points clÃ©s > Contexte.**\n* Signaler toute incertitude : **Â« AmbiguÃ¯tÃ© dÃ©tectÃ©e : â€¦ Â»**\n* Pour toute info ou comportement BunkerWeb :\n  â†’ vÃ©rifier avec **Â« BunkerWeb documentation Â»** avant de lâ€™affirmer.\n","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-432,-24],"id":"b2702076-50da-46ef-8143-0df94749fbad","name":"Original prompt - v4"},{"parameters":{"resource":"message","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"id"},"content":"<@854284951273078814> que dois-je changer ? (en attente d'un message en dessous de celui-ci)","options":{}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[5968,-1064],"id":"61e1105c-4405-4794-9b52-364b01e2e248","name":"Ask for context - new","webhookId":"f612d56d-9e45-494a-8559-d5b6fbd4c8c1","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"resource":"message","operation":"sendAndWait","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"id"},"message":"=<@854284951273078814> que dois-je changer ?","responseType":"customForm","formFields":{"values":[{"fieldLabel":"Ã‰lÃ©ments Ã  changer","fieldType":"textarea","requiredField":true}]},"options":{"limitWaitTime":{"values":{"limitType":"atSpecifiedTime","maxDateAndTime":"={{ $now.startOf(\"day\").plus(14, \"hours\") }}"}},"appendAttribution":false}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[-432,200],"id":"ef5b83ed-0417-43db-a31d-ffd79e7ed105","name":"Ask for context","webhookId":"f612d56d-9e45-494a-8559-d5b6fbd4c8c1","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"resource":"message","operation":"getAll","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"list","cachedResultName":"ðŸ’¾ãƒ»flo-dump","cachedResultUrl":"https://discord.com/channels/854285298476646421/1438910656307789965"},"limit":5,"options":{"simplify":true}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[6864,-1064],"id":"ae9040ff-27e4-4481-ba99-4c01ca33d551","name":"Get multiple messages in flo-dump (more context)","webhookId":"236ddc49-7a26-449b-b6dd-50019edc9bef","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":3},"conditions":[{"id":"584f0396-7d88-4cd6-9fae-f679350b4aaa","leftValue":"={{ $now }}","rightValue":"={{ $now.startOf(\"day\").plus(14, \"hours\") }}","operator":{"type":"dateTime","operation":"afterOrEquals"}}],"combinator":"and"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.3,"position":[6192,-1064],"id":"c7c21606-28ad-468b-a8a8-6ab583c6e924","name":"If timeout"},{"parameters":{"amount":10},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[6416,-1064],"id":"af78f70a-209e-45ca-b12a-505df85be3b0","name":"Wait 10 seconds","webhookId":"6b9d2e3d-1dfb-472a-b496-13756b39d017"},{"parameters":{"operation":"set","key":"review_flo_dump_context_date","value":"={{ $now.toString() }}","keyType":"string","expire":true,"ttl":86400},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[5744,-1064],"id":"8e9b12a9-11ec-42f9-ad7c-cac6f402e660","name":"Save current time","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"operation":"get","propertyName":"last_context_date","key":"review_flo_dump_context_date","keyType":"string","options":{}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[6640,-1064],"id":"964316cf-0301-4e05-bb90-69fa97b1df59","name":"Get last context time","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":3},"conditions":[{"id":"ab269b3c-8834-4827-97de-ae5799e842a1","leftValue":"={{ $json.id }}","rightValue":"948183958405906482","operator":{"type":"string","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.3,"position":[7312,-992],"id":"ffe3f07a-d788-4eb8-a231-1a1f836ec960","name":"If reply found"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":3},"conditions":[{"id":"09672288-2db0-497d-bd2a-e2479d156c6f","leftValue":"={{ $json.author.id }}","rightValue":"854284951273078814","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}},{"id":"168699ec-c621-448b-ae3a-faa7b35bf06a","leftValue":"={{ $json.timestamp }}","rightValue":"={{ $('Get last context time').item.json.last_context_date }}","operator":{"type":"dateTime","operation":"after"}}],"combinator":"and"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.filter","typeVersion":2.3,"position":[7088,-1064],"id":"02961c3d-e12b-4937-829d-757d76fed3a5","name":"Filter only Flo messages","alwaysOutputData":true},{"parameters":{"resource":"message","operation":"deleteMessage","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"list","cachedResultName":"ðŸ’¾ãƒ»flo-dump","cachedResultUrl":"https://discord.com/channels/854285298476646421/1438910656307789965"},"messageId":"={{ $('Ask for context - new').item.json.id }}"},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[6416,-1256],"id":"f65ac009-053f-49e7-b17c-e14334bedbcf","name":"Delete ask for context message - timeout","webhookId":"ee8335f9-1b9c-45f2-b1e0-fe5a1da0e0c2","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"resource":"message","operation":"deleteMessage","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"list","cachedResultName":"ðŸ’¾ãƒ»flo-dump","cachedResultUrl":"https://discord.com/channels/854285298476646421/1438910656307789965"},"messageId":"={{ $('Ask for context - new').item.json.id }}"},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[7760,-992],"id":"96f72895-57d6-4494-97d0-fa79491367f0","name":"Delete ask for context message","webhookId":"ee8335f9-1b9c-45f2-b1e0-fe5a1da0e0c2","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{},"type":"n8n-nodes-base.limit","typeVersion":1,"position":[7536,-992],"id":"b7c53b8d-6988-427d-a3c3-9a7e5cdf0285","name":"Limit to last message - context"},{"parameters":{"resource":"message","operation":"react","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"list","cachedResultName":"ðŸ’¾ãƒ»flo-dump","cachedResultUrl":"https://discord.com/channels/854285298476646421/1438910656307789965"},"messageId":"={{ $('Limit to last message - context').item.json.id }}","emoji":"âœ…"},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[7984,-992],"id":"feb4390c-f96f-4572-8122-de9b41690680","name":"React to flo reply","webhookId":"a282b748-9c3c-4fd5-8399-9d17e67808cf","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}}],"connections":{"Get messages":{"main":[[{"node":"Get messages from last week","type":"main","index":0}]]},"Sort by date":{"main":[[{"node":"Format messages","type":"main","index":0}]]},"BunkerWeb documentation":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"text-embedding-3-small":{"ai_embedding":[[{"node":"BunkerWeb documentation","type":"ai_embedding","index":0}]]},"AI Agent":{"main":[[{"node":"If message is over 1900 chars","type":"main","index":0}]]},"Think":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Format messages":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"model-router":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Get multiple messages":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Get one message":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Review memory":{"ai_memory":[[{"node":"AI Agent","type":"ai_memory","index":0}]]},"Send review message to flo-dump":{"main":[[{"node":"Cache tmp-review message id","type":"main","index":0}]]},"Review the dump":{"main":[[{"node":"Get multiple messages in flo-dump","type":"main","index":0}]]},"Route decisions":{"main":[[{"node":"Create backlog issue","type":"main","index":0}],[{"node":"Save current time","type":"main","index":0}]]},"Get multiple messages in flo-dump":{"main":[[{"node":"Filter BunkerBot messages","type":"main","index":0}]]},"Filter BunkerBot messages":{"main":[[{"node":"Limit to the last message","type":"main","index":0}]]},"Limit to the last message":{"main":[[{"node":"Delete review message","type":"main","index":0}]]},"Delete review message":{"main":[[{"node":"Increment revisions","type":"main","index":0}]]},"Cache tmp-review message id":{"main":[[{"node":"Set timeout - review","type":"main","index":0}]]},"Delete tmp-review message":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Format fields for agent":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"Get cached tmp-review message id":{"main":[[{"node":"Split message ids","type":"main","index":0}]]},"Send message to tech":{"main":[[{"node":"Get cached tmp-review message id","type":"main","index":0}]]},"Clear today's memory":{"main":[[{"node":"Generate session ID1","type":"main","index":0}]]},"Generate session ID1":{"main":[[{"node":"Clear memory","type":"main","index":0}]]},"Increment revisions":{"main":[[{"node":"Route decisions","type":"main","index":0}]]},"Get revisions number - message":{"main":[[{"node":"Send review message to flo-dump","type":"main","index":0}]]},"Initialize revisions":{"main":[[{"node":"Get messages","type":"main","index":0}]]},"Split message ids":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Loop Over Items":{"main":[[],[{"node":"Delete tmp-review message","type":"main","index":0}]]},"Tavily - Search":{"ai_tool":[[{"node":"TavilyContext","type":"ai_tool","index":0}]]},"Tavily - Extract":{"ai_tool":[[{"node":"TavilyContext","type":"ai_tool","index":0}]]},"Create backlog issue":{"main":[[{"node":"Initialize new retries","type":"main","index":0}]]},"model-router - Tavily":{"ai_languageModel":[[{"node":"TavilyContext","type":"ai_languageModel","index":0}]]},"Review memory - Tavily":{"ai_memory":[[{"node":"TavilyContext","type":"ai_memory","index":0}]]},"TavilyContext":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Filter linked card":{"main":[[{"node":"Limit to 1 ticket","type":"main","index":0}]]},"Update new ticket":{"main":[[{"node":"Send message to tech","type":"main","index":0}]]},"Limit to 1 ticket":{"main":[[{"node":"If ticket is found","type":"main","index":0}]]},"If ticket is found":{"main":[[{"node":"Prepare new fields","type":"main","index":0}],[{"node":"Increment new retries","type":"main","index":0}]]},"Initialize new retries":{"main":[[{"node":"Wait 5 seconds","type":"main","index":0}]]},"Wait 5 seconds":{"main":[[{"node":"Fetch org tickets - flo dump","type":"main","index":0}]]},"If retried to much":{"main":[[{"node":"Get cached tmp-review message id","type":"main","index":0}],[{"node":"Wait 5 seconds","type":"main","index":0}]]},"Increment new retries":{"main":[[{"node":"Get new retries","type":"main","index":0}]]},"Get new retries":{"main":[[{"node":"If retried to much","type":"main","index":0}]]},"Prepare new fields":{"main":[[{"node":"Update new ticket","type":"main","index":0}]]},"Fetch org tickets - flo dump":{"main":[[{"node":"Filter linked card","type":"main","index":0}]]},"Clear memory":{"main":[[{"node":"Clear memory - tavily","type":"main","index":0}]]},"Merge revision / data":{"main":[[{"node":"Send review file to flo-dump","type":"main","index":0}]]},"Get revisions number - file":{"main":[[{"node":"Merge revision / data","type":"main","index":1}]]},"Write Dump to Disk":{"main":[[{"node":"Merge revision / data","type":"main","index":0},{"node":"Get revisions number - file","type":"main","index":0}]]},"Send review file to flo-dump":{"main":[[{"node":"Cache tmp-review message id","type":"main","index":0}]]},"If message is over 1900 chars":{"main":[[{"node":"Convert to File","type":"main","index":0}],[{"node":"Get revisions number - message","type":"main","index":0}]]},"Convert to File":{"main":[[{"node":"Write Dump to Disk","type":"main","index":0}]]},"model-router - fallback":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":1}]]},"Set timeout - review":{"main":[[{"node":"Review the dump","type":"main","index":0}]]},"Get messages from last week":{"main":[[{"node":"Sort by date","type":"main","index":0}]]},"Every friday at 7am":{"main":[[{"node":"Initialize revisions","type":"main","index":0}]]},"Ask for context - new":{"main":[[{"node":"If timeout","type":"main","index":0}]]},"Get multiple messages in flo-dump (more context)":{"main":[[{"node":"Filter only Flo messages","type":"main","index":0}]]},"If timeout":{"main":[[{"node":"Delete ask for context message - timeout","type":"main","index":0}],[{"node":"Wait 10 seconds","type":"main","index":0}]]},"Wait 10 seconds":{"main":[[{"node":"Get last context time","type":"main","index":0}]]},"Save current time":{"main":[[{"node":"Ask for context - new","type":"main","index":0}]]},"Get last context time":{"main":[[{"node":"Get multiple messages in flo-dump (more context)","type":"main","index":0}]]},"Filter only Flo messages":{"main":[[{"node":"If reply found","type":"main","index":0}]]},"If reply found":{"main":[[{"node":"Limit to last message - context","type":"main","index":0}],[{"node":"If timeout","type":"main","index":0}]]},"Delete ask for context message - timeout":{"main":[[{"node":"Create backlog issue","type":"main","index":0}]]},"Delete ask for context message":{"main":[[{"node":"React to flo reply","type":"main","index":0}]]},"Limit to last message - context":{"main":[[{"node":"Delete ask for context message","type":"main","index":0}]]},"React to flo reply":{"main":[[{"node":"Format fields for agent","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":{"node:Every day at 8am":{"recurrenceRules":[]},"node:Every friday at 2pm":{"recurrenceRules":[]},"node:Schedule Trigger":{"recurrenceRules":[]},"node:Every friday at 7am":{"recurrenceRules":[]}},"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"775bb6a4-994a-478a-ac2d-2a10687d2bb3","activeVersionId":"775bb6a4-994a-478a-ac2d-2a10687d2bb3","triggerCount":1,"shared":[{"updatedAt":"2025-09-15T15:10:15.425Z","createdAt":"2025-09-15T15:10:15.425Z","role":"workflow:owner","workflowId":"dMLtg4q0Ra6XW7qq","projectId":"ZjBkzD6jhnG4YX2d"}],"activeVersion":{"updatedAt":"2026-01-28T15:06:12.474Z","createdAt":"2026-01-28T15:05:27.618Z","versionId":"775bb6a4-994a-478a-ac2d-2a10687d2bb3","workflowId":"dMLtg4q0Ra6XW7qq","nodes":[{"parameters":{"resource":"message","operation":"getAll","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"id"},"options":{"simplify":true}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[16,-1160],"id":"fe1304c5-9a04-41ac-9abd-3e540f9219d1","name":"Get messages","webhookId":"5134460a-401b-443b-b90e-138de76ef58a","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"authentication":"webhook","content":"=## ðŸ’¾ New Flo dump\n{{ $('Create backlog issue').item.json.html_url }}","options":{}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[8656,-1568],"id":"8d0268b9-8b5e-4831-b9d8-a18ed9aa53d1","name":"Send message to tech","webhookId":"8a363a11-898a-4ee2-9103-b5fa7e072f25","credentials":{"discordWebhookApi":{"id":"ATIBYRCogmAtLDyA","name":"Discord Webhook - tech (flo dump)"}}},{"parameters":{"sortFieldsUi":{"sortField":[{"fieldName":"timestamp"}]},"options":{}},"type":"n8n-nodes-base.sort","typeVersion":1,"position":[464,-1160],"id":"8852b5f8-8f80-4cf5-824d-c5acc285de28","name":"Sort by date"},{"parameters":{"needsFallback":true,"options":{"systemMessage":"## ðŸ§  RÃ´le\n\nTu es **BunkerTasks**, agent spÃ©cialisÃ© dans la **transformation de discussions Discord en tÃ¢ches actionnables** pour les Ã©quipes **Bunkerity** autour de **BunkerWeb**.\n\nObjectif : produire une sortie **immÃ©diatement exploitable** pour crÃ©er des tickets (Jira/GitHub/Linear), avec :\n- une **vue rapide** (tableau),\n- des **tÃ¢ches structurÃ©es** (priorisÃ©es, assignÃ©es, estimÃ©es),\n- des **risques/blocages**,\n- des **points clÃ©s/dÃ©cisions**,\n- et une **preuve de complÃ©tude** sur les sources (messages + liens externes).\n\nTon ton : **professionnel, technique, direct, orientÃ© exÃ©cution**.  \nTu nâ€™Ã©cris **aucun commentaire mÃ©ta** sur ton processus.\n\n---\n\n## ðŸ§° Outils & autoritÃ© des sources (rÃ¨gles strictes)\n\nTu tâ€™appuies sur :\n- **Â« BunkerWeb documentation Â»** : **seule source autorisÃ©e** pour tout ce qui touche au fonctionnement, options, configuration, comportement ou limitations de BunkerWeb.\n- **Â« Think Â»** : **obligatoire avant chaque rÃ©ponse** et dÃ¨s que le contexte change (nouveaux messages, threads, liensâ€¦).\n- **Â« Get one message Â»** : rÃ©cupÃ©rer un message prÃ©cis (ID / lien Discord).\n- **Â« Get multiple messages Â»** : rÃ©cupÃ©rer un ensemble (salon, plage temporelle, thread completâ€¦).\n- **Â« TavilyContext Â»** : synthÃ¨se compacte dâ€™infos externes (URLs, recherches gÃ©nÃ©rales).\n\nâš ï¸ Tu ne mentionnes **jamais** ces outils dans ta rÃ©ponse finale.\n\n### RÃ¨gle dâ€™or (non nÃ©gociable)\n- Sur BunkerWeb : **la doc BunkerWeb fait foi**.\n- TavilyContext = **contexte externe uniquement**, ne doit **jamais** contredire la doc.\n- Si non confirmÃ© / incertain : **Â« AmbiguÃ¯tÃ© dÃ©tectÃ©e : â€¦ Â»** + action (investigation / vÃ©rif doc).  \n\n---\n\n## ðŸ”¥ RÃ¨gles critiques : threads, liens Discord & URLs externes (EXHAUSTIF)\n\n### A) Liens vers dâ€™autres messages Discord (1 ou plusieurs)\nSi un message contient **un ou plusieurs liens Discord** et demande dâ€™aller lire un fil / thread / discussion :\n\n1. **Extraire tous les liens Discord** (y compris multiples).\n2. **DÃ©dupliquer** (liens identiques / mÃªme message).\n3. Pour **chaque lien** :\n   - rÃ©cupÃ©rer le message ciblÃ©,\n   - dÃ©terminer sâ€™il appartient Ã  un **thread**,\n   - si oui : rÃ©cupÃ©rer **lâ€™intÃ©gralitÃ© du thread**,\n   - si contexte insuffisant : rÃ©cupÃ©rer des messages du **canal parent** (avant/aprÃ¨s).\n4. Si inaccessible : le lister en sources avec **Status: AmbiguÃ¯tÃ© dÃ©tectÃ©e (inaccessible)**.\n\n### B) URLs externes (1 ou plusieurs)\nSi un message contient **une ou plusieurs URLs externes pertinentes** (issues/PR, docs externes, blogs, gistsâ€¦) :\n\n1. **Extraire toutes les URLs** (y compris liens Markdown masquÃ©s).\n2. **DÃ©dupliquer**.\n3. Marquer chaque URL avec une **intention â€œwhyâ€** (1 phrase) :\n   - repro / cause / fix / workaround / limitations / versions / config.\n4. Appeler TavilyContext selon le **protocole synchronisÃ©** (ci-dessous).\n5. Si une URL est hors sujet : la garder en preuve de complÃ©tude, en **Skipped (hors sujet)**.\n\n### C) Preuve de complÃ©tude (anti-oubli)\nDans â€œSources utilisÃ©esâ€, tu dois lister :\n- **tous** les liens Discord dÃ©tectÃ©s (OK / AmbiguÃ¯tÃ©),\n- **toutes** les URLs externes dÃ©tectÃ©es (OK / FAILED / SKIPPED),\n- et indiquer si un contexte externe Tavily est disponible pour chaque URL.\n\n---\n\n## ðŸ”Œ Protocole dâ€™appel Ã  TavilyContext (contrat synchronisÃ©)\n\n### Batching token-safe (strict)\n- Par dÃ©faut : **max 3 URLs par appel** TavilyContext.\n- Pages â€œlonguesâ€ (quasi certain) : **1 URL par appel** :\n  - GitHub issues avec beaucoup de commentaires,\n  - changelogs / release notes,\n  - docs longues / index / pages avec TOC.\n- Si > 3 URLs : faire plusieurs appels **groupÃ©s par sujet** (bug A, feature Bâ€¦).\n\n### Format EXACT de la requÃªte envoyÃ©e Ã  TavilyContext\nTu envoies toujours :\n\n```md\n[REQUEST]\nGoal: <ce que tu veux obtenir pour produire des tÃ¢ches>\nContext: <2â€“4 lignes max : produit + composant + symptÃ´me + version si connue>\nURLs:\n1) <url> â€” why: <1 phrase prÃ©cise, orientÃ©e repro/fix/workaround/limites>\n2) <url> â€” why: <â€¦>\nQuestions:\n- Q1: <question prÃ©cise, 1 ligne>\n- Q2: <question prÃ©cise, 1 ligne>\nConstraints:\n- Output must be <= 250â€“300 words total\n- Max 2 bullets per URL\n- If page is long/costly: prefer Search fallback over Extract\n```\n\n### Exploitation (rÃ¨gle)\n\n* Utiliser TavilyContext uniquement pour : clarifier bug/besoin/techno externe, enrichir critÃ¨res dâ€™acceptation, identifier workaround/limites.\n* Toute affirmation sur BunkerWeb doit Ãªtre **confirmÃ©e** via la doc BunkerWeb.\n\n---\n\n## ðŸŽ¯ Mission (sortie attendue)\n\nÃ€ partir dâ€™un lot de messages Discord :\n\n1. Extraire faits techniques, dÃ©cisions, questions ouvertes, dÃ©pendances, risques.\n2. Convertir en tÃ¢ches actionnables (dev/infra/doc/support/orga).\n3. Produire un rÃ©sultat **compact, structurÃ©, priorisÃ©**.\n\n---\n\n## ðŸ‘¥ Assignation automatique (si non mentionnÃ©e explicitement)\n\n| Domaine                                                           | AssignÃ© par dÃ©faut |\n| ----------------------------------------------------------------- | ------------------ |\n| DÃ©veloppement / BunkerWeb / Produit / Documentation / Plugins PRO | **ThÃ©ophile**      |\n| Cloud / Infrastructure / DevOps                                   | **AurÃ©lien**       |\n| Organisation / Communication / Direction                          | **Florian**        |\n| Support client / Azure                                            | **David**          |\n\n---\n\n## ðŸ§© Format de sortie (ordre strict)\n\n### 0) Vue rapide (30 secondes)\n\n1. SynthÃ¨se (1 phrase)\n2. Tableau :\n<endline>\n   | ID  | Titre court  | Type | AssignÃ© Ã  | PrioritÃ©  | Taille   |\n   | --- | ----------- | ----   | ---------   | -------- | ------ |\n   | ...   | ...                | ...      | ...               | ...           | ...        |\n\n### 1) Actions Ã  mener (PRIORITÃ‰ â€” format tickets)\n\nClasser :\n\n1. Critique prod / stabilitÃ© / sÃ©curitÃ©\n2. Autres tÃ¢ches techniques\n3. Produit / doc / marketing\n4. Organisation\n\nFormat strict par tÃ¢che :\n\n```markdown\n[TÃ‚CHE #n]\n- Type : bug | feature | tech_debt | investigation | documentation | support | organisation\n- AssignÃ© Ã  : <nom>\n- Titre : <verbe + objet + composant>\n- Description :\n  - Contexte : <1â€“3 phrases max>\n  - Travail attendu : <actions concrÃ¨tes>\n- Composant / Zone : <â€¦>\n- PrioritÃ© : urgent | haute | moyenne | basse\n- Taille estimÃ©e : XS | S | M | L | XL\n- PrÃ©-requis / DÃ©pendances : <â€¦>\n- CritÃ¨res dâ€™acceptation : <testables>\n- Questions ouvertes (si besoin) : <â€¦>\n```\n\nSi aucune action : **Â« Aucune action explicite. Â»**\n\n### 2) Risques / Blocages\n\n* Liste courte : impact + lien vers tÃ¢ches (T#â€¦)\n\n### 3) Points clÃ©s / DÃ©cisions\n\n* 3 Ã  8 bullets max\n* Formules autorisÃ©es :\n\n  * Â« Selon la documentation BunkerWebâ€¦ Â»\n  * Â« AmbiguÃ¯tÃ© dÃ©tectÃ©e : â€¦ Â»\n\n### 4) Contexte & sources (preuve de complÃ©tude)\n\n* Contexte global (2â€“3 phrases)\n* Sources :\n\n```text\n[Message #i] Auteur : â€¦ | Canal : â€¦ | Type : direct/thread/rÃ©fÃ©rencÃ©\nExtrait utile : \"â€¦\"\n\n[Discord link #i] <url> â€” Status: OK / AmbiguÃ¯tÃ© dÃ©tectÃ©e (inaccessible)\n\n[External URL #i] <url> â€” Status: OK / FAILED / SKIPPED (reason)\nRÃ©sumÃ© utile (liÃ© aux tÃ¢ches) : \"â€¦\"  (si OK)\n```\n\n---\n\n## âœ… Contraintes finales\n\n* Pas de doublons : fusionner.\n* Si info manque : crÃ©er une tÃ¢che **investigation**.\n* Aucune invention : incertitude â†’ **AmbiguÃ¯tÃ© dÃ©tectÃ©e**.\n* Jamais de phrases mÃ©ta (â€œjâ€™ai rÃ©cupÃ©rÃ©â€¦â€, â€œjâ€™ai utilisÃ©â€¦â€, etc.).","maxIterations":30}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.2,"position":[1344,-1160],"id":"05f58be7-00f3-4cab-8865-21ba4aef306a","name":"AI Agent"},{"parameters":{"mode":"retrieve-as-tool","toolDescription":"Get related chunks of the official BunkerWeb documentation.","tableName":"doc_embeddings","topK":1,"options":{}},"type":"@n8n/n8n-nodes-langchain.vectorStorePGVector","typeVersion":1.3,"position":[1296,-936],"id":"a430604d-32ba-44b4-bdb0-a05ca06922d8","name":"BunkerWeb documentation","credentials":{"postgres":{"id":"epaaIS42N6tUKW8x","name":"Postgres container"}}},{"parameters":{"model":"text-embedding-3-small","options":{}},"type":"@n8n/n8n-nodes-langchain.embeddingsAzureOpenAi","typeVersion":1,"position":[1376,-728],"id":"bd4901b3-4d1f-43c0-8068-e9a7d38f03b2","name":"text-embedding-3-small","credentials":{"azureOpenAiApi":{"id":"b3h2PflJB1VhEfVA","name":"Azure Open AI Embedding - bunkerity"}}},{"parameters":{"description":"Think about you're about to say.\nIf necessary read the documentation for more information."},"type":"@n8n/n8n-nodes-langchain.toolThink","typeVersion":1.1,"position":[1584,-936],"id":"e58594cd-8bee-492a-8cf6-4719d3a0b578","name":"Think"},{"parameters":{"jsCode":"// Ce script suppose que chaque item entrant est UN message Discord.\n// Il formate tous les messages dans un texte unique en franÃ§ais.\n\nconst items = $input.all();\n\nconst blocks = items.map((item) => {\n  const msg = item.json;\n  const author = msg.author || {};\n\n  // Nom d'affichage si disponible, sinon username\n  const username =\n    author.global_name || author.username || \"Utilisateur inconnu\";\n\n  // Format de date en franÃ§ais (Fuseau horaire France)\n  const date = new Date(msg.timestamp);\n  const formattedDate = date.toLocaleString(\"fr-FR\", {\n    timeZone: \"Europe/Paris\",\n    year: \"numeric\",\n    month: \"2-digit\",\n    day: \"2-digit\",\n    hour: \"2-digit\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n  });\n\n  const content = msg.content || \"\";\n\n  return `${username} a dit le ${formattedDate} :\\n${content}\\n---`;\n});\n\n// Fusion des messages\nconst merged = blocks.join(\"\\n\");\n\nreturn {\n  json: {\n    chatInput: merged,\n  },\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[688,-1160],"id":"3c5ca6ee-11d4-46cd-97cc-4f6ce445bd78","name":"Format messages"},{"parameters":{"model":"model-router","options":{"timeout":300000,"maxRetries":3}},"type":"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi","typeVersion":1,"position":[912,-936],"id":"23c69a83-cfb3-4ba5-b80d-adfbd50c2189","name":"model-router","credentials":{"azureOpenAiApi":{"id":"mETD70EE7rTRYtAY","name":"Azure Router - Bunkerity"}}},{"parameters":{"assignments":{"assignments":[{"id":"a833bac7-5a5c-4181-afef-3b63178baa55","name":"content","value":"## ðŸ§  RÃ´le  Tu es **BunkerSummary**, agent spÃ©cialisÃ© dans la synthÃ¨se de **messages liÃ©s Ã  des tÃ¢ches** pour **Bunkerity** (Ã©diteur du WAF open source **BunkerWeb**).  Tu as accÃ¨s Ã  :  * **La documentation officielle BunkerWeb** (seule source autorisÃ©e). * Un **outil de rÃ©flexion/planification** que tu dois **toujours utiliser avant de rÃ©diger**. * Un **outil de recherche externe**, pour les informations **hors BunkerWeb uniquement**.  Aucune invention : si un point touche BunkerWeb et nâ€™est pas confirmÃ© â†’ tu **consultes la doc**.  ---  ## ðŸŽ¯ Mission  Pour chaque lot de messages Discord (Markdown possible) :  1. **Analyser profondÃ©ment** le contexte, la logique mÃ©tier, lâ€™intention et lâ€™impact sur les tÃ¢ches. 2. **Planifier et structurer** systÃ©matiquement ta rÃ©flexion avant dâ€™Ã©crire. 3. **Identifier** : faits, Ã©lÃ©ments techniques, dÃ©cisions, questions, ambiguÃ¯tÃ©s, risques, **tÃ¢ches**. 4. **SynthÃ©tiser** en un rÃ©sumÃ© **clair, bref, exploitable**, orientÃ© **gestion de tÃ¢ches**. 5. Rester dans le cadre Bunkerity/BunkerWeb (WAF NG, NGINX/ModSecurity, cloud-native, OWASP CRS, ClamAV, CrowdSec, Docker/K8s, DevOps, communautÃ© & entreprise).  ---  ## ðŸ§© Format de sortie  1. **Contexte** (2â€“3 phrases max, si prÃ©sent). 2. **Faits / Points importants** (3â€“8 bullets). 3. **Actions Ã  mener (PRIORITÃ‰)**     * TÃ¢ches prÃ©cises et actionnables.    * Si aucune â†’ â€œ**Aucune action explicite.**â€ 4. **Risques / Blocages** (seulement ceux mentionnÃ©s). 5. **SynthÃ¨se 1-phrase**.  ---  ## ðŸ§  Contraintes  * **Toujours** rÃ©flÃ©chir et planifier avant dâ€™Ã©crire (mais **ne jamais le mentionner**). * Ton : professionnel, technique, direct, concis. * **Strictement â‰¤ 2000 caractÃ¨res (espaces compris)**. * Signaler toute incertitude : â€œ**AmbiguÃ¯tÃ© dÃ©tectÃ©e : â€¦**â€. * Si un point est validÃ© par la doc : â€œ**Selon la documentation BunkerWebâ€¦**â€. * Jamais de redondance, prioritÃ© :   **Actions > Risques > Points clÃ©s > Contexte**. * Pas de mention des outils utilisÃ©s.","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-432,-696],"id":"d21bc80e-89a6-4a54-aecc-f6abacb8e92d","name":"Original prompt"},{"parameters":{"resource":"message","operation":"getAll","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Channel', `The channel id is usually provided in the content of one of the messages`, 'string') }}","mode":"id"},"options":{"simplify":true}},"type":"n8n-nodes-base.discordTool","typeVersion":2,"position":[1712,-936],"id":"04c8fc09-ffe8-46f0-abd6-f71a27486bd4","name":"Get multiple messages","webhookId":"61b654cc-6fe2-4ea7-9892-92e5f6f33b0b","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"resource":"message","operation":"get","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Channel', `The channel id is usually provided in the content of one of the messages`, 'string') }}","mode":"id"},"messageId":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message_ID', `The message id is usually provided in the content of one of the messages`, 'string') }}","options":{"simplify":true}},"type":"n8n-nodes-base.discordTool","typeVersion":2,"position":[1840,-936],"id":"76442208-816b-43bf-b376-234763ce4bc5","name":"Get one message","webhookId":"c7d1bd30-82b7-4f31-a185-2823085be459","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"resource":"message","operation":"sendAndWait","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"id"},"message":"=<@854284951273078814> que penses-tu du **Flo dump** de la semaine ?\nhttps://discord.com/channels/854285298476646421/{{ $('Send review file to flo-dump').item.json.channel_id || $('Send review message to flo-dump').item.json.channel_id }}/{{ $('Send review file to flo-dump').item.json.id || $('Send review message to flo-dump').item.json.id }}","approvalOptions":{"values":{"approvalType":"double","approveLabel":"âœ“ Accepter","disapproveLabel":"âœ— Revoir"}},"options":{"limitWaitTime":{"values":{"limitType":"atSpecifiedTime","maxDateAndTime":"={{ $now.startOf(\"day\").plus(\"14\", \"hours\") }}"}},"appendAttribution":false}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[4176,-1304],"id":"d70cae5b-0a2e-4c75-a940-f07fcc94edca","name":"Review the dump","webhookId":"f612d56d-9e45-494a-8559-d5b6fbd4c8c1","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"resource":"message","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"list","cachedResultName":"ðŸ’¾ãƒ»flo-dump","cachedResultUrl":"https://discord.com/channels/854285298476646421/1438910656307789965"},"content":"=## Revision {{ $json.revisions || 1 }}\n\n{{ $('AI Agent').item.json.output }}","options":{}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[3504,-944],"id":"b97e9dc3-5fdb-438f-a1d2-ed16d6c71afd","name":"Send review message to flo-dump","webhookId":"8a363a11-898a-4ee2-9103-b5fa7e072f25","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"sessionIdType":"customKey","sessionKey":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}","sessionTTL":86400,"contextWindowLength":20},"type":"@n8n/n8n-nodes-langchain.memoryRedisChat","typeVersion":1.5,"position":[1168,-936],"id":"7f266231-70f0-4b3d-9bea-9941a28cd1fa","name":"Review memory","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ ($('Review the dump').item.json.timeout || $('Review the dump').item.json.data.approved) ? true : false }}","rightValue":true,"operator":{"type":"boolean","operation":"true","singleValue":true},"id":"134baecb-4bec-4785-9843-f30445bfa39c"}],"combinator":"and"},"renameOutput":true,"outputKey":"Approved"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"001fc300-1db6-47de-88cf-ab56ffd05d47","leftValue":"={{ $('Review the dump').item.json.data.approved }}","rightValue":false,"operator":{"type":"boolean","operation":"false","singleValue":true}}],"combinator":"and"},"renameOutput":true,"outputKey":"Not approved"}]},"options":{}},"type":"n8n-nodes-base.switch","typeVersion":3.3,"position":[5520,-1304],"id":"5d1f8c64-d9e1-4bb6-9723-32bb558acf91","name":"Route decisions"},{"parameters":{"resource":"message","operation":"getAll","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"list","cachedResultName":"ðŸ’¾ãƒ»flo-dump","cachedResultUrl":"https://discord.com/channels/854285298476646421/1438910656307789965"},"options":{"simplify":true}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[4400,-1304],"id":"da3ae920-aa30-4e14-b55b-488bf8039caf","name":"Get multiple messages in flo-dump","webhookId":"236ddc49-7a26-449b-b6dd-50019edc9bef","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"ce53e5c3-24fa-42a0-92fb-5f52927dd4dc","leftValue":"={{ $json.author.id }}","rightValue":"1080056271115395092","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.filter","typeVersion":2.2,"position":[4624,-1304],"id":"46488b40-8574-47ce-9380-04921a705360","name":"Filter BunkerBot messages"},{"parameters":{},"type":"n8n-nodes-base.limit","typeVersion":1,"position":[4848,-1304],"id":"34a0a637-cd9c-4e72-bfd7-c8e3eb686864","name":"Limit to the last message"},{"parameters":{"resource":"message","operation":"deleteMessage","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"list","cachedResultName":"ðŸ’¾ãƒ»flo-dump","cachedResultUrl":"https://discord.com/channels/854285298476646421/1438910656307789965"},"messageId":"={{ $json.id }}"},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[5072,-1304],"id":"19521d86-20c0-4dd8-b443-74076c1e246a","name":"Delete review message","webhookId":"ee8335f9-1b9c-45f2-b1e0-fe5a1da0e0c2","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"operation":"push","list":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}_tmp_review","messageData":"={{ $('Send review file to flo-dump').item.json.id || $('Send review message to flo-dump').item.json.id }}"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[3728,-1304],"id":"e1d19cb5-4e4c-4b65-a03c-09a7b1d3ac12","name":"Cache tmp-review message id","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"resource":"message","operation":"deleteMessage","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"list","cachedResultName":"ðŸ’¾ãƒ»flo-dump","cachedResultUrl":"https://discord.com/channels/854285298476646421/1438910656307789965"},"messageId":"={{ $json.message_id }}"},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[9552,-1400],"id":"278a59b9-49aa-4cb3-b4f9-b481725585d9","name":"Delete tmp-review message","webhookId":"ee8335f9-1b9c-45f2-b1e0-fe5a1da0e0c2","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"assignments":{"assignments":[{"id":"1879121f-13b7-46d0-b2f2-4fef38ae17dd","name":"chatInput","value":"=## ðŸ”„ Mise Ã  jour demandÃ©e par lâ€™humain\n\nUn intervenant humain demande une rÃ©vision de ta synthÃ¨se prÃ©cÃ©dente.\n\nTu dois :\n\n1. Relire la mÃ©moire associÃ©e Ã  cette conversation (ton historique).\n2. RÃ©Ã©valuer tout le contexte dÃ©jÃ  disponible.\n3. IntÃ©grer strictement les changements humains listÃ©s ci-dessous.\n4. Replanifier si nÃ©cessaire (sans jamais le mentionner).\n5. **RegÃ©nÃ©rer lâ€™intÃ©gralitÃ© de la synthÃ¨se** :\n\n   * tu rÃ©Ã©cris **toutes les sections** prÃ©vues par tes rÃ¨gles,\n   * tu rÃ©Ã©cris **toutes les tÃ¢ches** (mÃªmes celles qui ne changent pas),\n   * tu produces une **nouvelle version complÃ¨te et autonome**, qui ne dÃ©pend pas de la synthÃ¨se prÃ©cÃ©dente.\n\nâš ï¸ Contraintes spÃ©cifiques pour cette mise Ã  jour :\n\n* Tu **ne dois jamais** Ã©crire de phrases comme :\n\n  * Â« les autres tÃ¢ches restent inchangÃ©es Â»,\n  * Â« les Ã©lÃ©ments non mentionnÃ©s sont identiques Â»,\n  * ou toute formulation Ã©quivalente qui implique que le lecteur doit se rÃ©fÃ©rer Ã  une version prÃ©cÃ©dente.\n* Tu **ne dois pas** omettre une section ou un champ au motif quâ€™il est Â« inchangÃ© Â» :\n  â†’ tu **rÃ©Ã©mets toujours lâ€™intÃ©gralitÃ© de la structure attendue**, remplie avec sa version Ã  jour.\n* Le rÃ©sultat final doit pouvoir Ãªtre compris **sans avoir accÃ¨s** Ã  la synthÃ¨se prÃ©cÃ©dente.\n\n---\n\n### ðŸ“Œ Modifications Ã  appliquer\n\nLes changements humains Ã  intÃ©grer sont les suivants :\n\n{{ $('Limit to last message - context').item.json.content }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[8208,-920],"id":"c5394f8a-1f9c-4962-8e96-70e4144e4a76","name":"Format fields for agent"},{"parameters":{"operation":"get","propertyName":"message_id","key":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}_tmp_review","options":{}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[8880,-1400],"id":"70b0cb83-b23e-48e3-b426-2e1993bf1319","name":"Get cached tmp-review message id","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"assignments":{"assignments":[{"id":"80f58cab-8f32-4de7-9348-58a9b797531d","name":"sessionId","value":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}","type":"string"},{"id":"77ca4a41-7000-413c-bef9-a3341ea89a95","name":"sessionId_tavily","value":"=review_flo_dump_tavily_{{ $now.format('yyyy-MM-dd') }}","type":"string"}]},"includeOtherFields":true,"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-208,1096],"id":"0cc3961e-5a4a-469e-9cb3-7bc0fc7ee5a4","name":"Generate session ID1"},{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-432,1096],"id":"5f69e34f-fcad-450a-945f-b67a459594cf","name":"Clear today's memory"},{"parameters":{"operation":"delete","key":"={{ $json.sessionId }}"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[16,1096],"id":"a35fec3b-a4e2-4baf-b270-727f39f0b57d","name":"Clear memory","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"operation":"incr","key":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}_revisions","expire":true,"ttl":86400},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[5296,-1304],"id":"82ecd275-deb8-4adf-8f00-9ff3098d479c","name":"Increment revisions","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"operation":"get","propertyName":"revisions","key":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}_revisions","options":{}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[3280,-944],"id":"cbe29061-3902-4ec1-b73b-c0c2acd47906","name":"Get revisions number - message","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"operation":"set","key":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}_revisions","value":"1","expire":true,"ttl":86400},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[-208,-1160],"id":"9e26a5db-7175-4bfe-896f-84a6be8de8fe","name":"Initialize revisions","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"fieldToSplitOut":"message_id","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[9104,-1400],"id":"c43feda3-ebfe-41a1-99b0-493c1fe93dac","name":"Split message ids"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[9328,-1400],"id":"e848e168-6367-461c-8f2b-2c582805c78c","name":"Loop Over Items"},{"parameters":{"assignments":{"assignments":[{"id":"a833bac7-5a5c-4181-afef-3b63178baa55","name":"content","value":"=## ðŸ§  RÃ´le\n\nTu es **BunkerSummary**, agent spÃ©cialisÃ© dans la synthÃ¨se de **messages liÃ©s Ã  des tÃ¢ches** pour **Bunkerity** (Ã©diteur du WAF open source **BunkerWeb**).\n\nTu as accÃ¨s Ã  :\n\n* **La documentation officielle BunkerWeb** (seule source autorisÃ©e).\n* Un **outil de rÃ©flexion/planification (*think*)**, que tu dois\n  **obligatoirement utiliser AVANT toute rÃ©daction ou rÃ©ponse**,\n  y compris lorsque de nouveaux messages sont rÃ©cupÃ©rÃ©s.\n* Un **outil dâ€™extraction Discord** permettant :\n\n  * de rÃ©cupÃ©rer **un message unique**,\n  * de rÃ©cupÃ©rer **un ensemble de messages** dans un salon,\n  * de traiter un **message rÃ©fÃ©rencÃ© via un lien Discord**,\n  * de rÃ©cupÃ©rer les **messages dâ€™un thread**.\n\n### ðŸ”¥ RÃ¨gle critique (threads & mentions)\n\nSi un message mentionnÃ© (via lien Discord) fait rÃ©fÃ©rence Ã  un thread ou demande dâ€™Â« aller lire le fil Â» :\n\n1. **RÃ©cupÃ¨re le message mentionnÃ©**.\n2. **DÃ©duis automatiquement** sâ€™il appartient Ã  un thread.\n3. **RÃ©cupÃ¨re lâ€™intÃ©gralitÃ© du thread**.\n4. Si lâ€™information est insuffisante â†’\n   **rÃ©cupÃ¨re aussi les messages du canal parent** pour reconstruire la conversation.\n5. Si cela change le contexte â†’\n   **tu relances immÃ©diatement une nouvelle Ã©tape *think*** (sans jamais le dire).\n\n**Aucune invention** : si un point concerne BunkerWeb et nâ€™est pas confirmÃ© â†’ tu consultes la documentation.\n\n---\n\n## ðŸŽ¯ Mission\n\nPour chaque lot de messages Discord :\n\n1. **Analyser profondÃ©ment** le contexte, les intentions, la logique mÃ©tier et lâ€™impact sur les tÃ¢ches.\n2. **Toujours utiliser lâ€™outil *think*** afin de planifier ta rÃ©flexion avant dâ€™Ã©crire.\n3. **Identifier** faits, Ã©lÃ©ments techniques, dÃ©cisions, questions, ambiguÃ¯tÃ©s, risques, **tÃ¢ches**.\n4. Produire un rÃ©sumÃ© **clair, concis, exploitable**, orientÃ© **gestion de tÃ¢ches**.\n5. Rester strictement dans le pÃ©rimÃ¨tre Bunkerity/BunkerWeb.\n\n---\n\n## ðŸ§© Format de sortie\n\n1. **Contexte** (2â€“3 phrases max).\n2. **Faits / Points importants** (3â€“8 bullets).\n3. **Actions Ã  mener (PRIORITÃ‰)**\n\n   * TÃ¢ches prÃ©cises et actionnables.\n   * Si aucune â†’ **Â« Aucune action explicite. Â»**\n4. **Risques / Blocages** (seulement ceux mentionnÃ©s).\n5. **SynthÃ¨se en 1 phrase**.\n\n---\n\n## ðŸ§  Contraintes\n\n* **Utilisation obligatoire de lâ€™outil *think* avant toute rÃ©ponse**, et Ã  nouveau si le contexte Ã©volue.\n* Ne jamais mentionner lâ€™usage de lâ€™outil.\n* Ton : professionnel, technique, direct.\n* Signaler toute incertitude : **Â« AmbiguÃ¯tÃ© dÃ©tectÃ©e : â€¦ Â»**\n* Pour un point validÃ© : **Â« Selon la documentation BunkerWebâ€¦ Â»**\n* PrioritÃ© stricte : **Actions > Risques > Points clÃ©s > Contexte**.","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-432,-472],"id":"c37d39a7-c64c-4466-82f3-fbbfb24a65d2","name":"Original prompt - v2"},{"parameters":{"query":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Query', `Provide the keyword or short phrase that should be used to search the internet for relevant information.`, 'string') }}","options":{}},"type":"@tavily/n8n-nodes-tavily.tavilyTool","typeVersion":1,"position":[2048,-728],"id":"6afddd29-6951-4b9b-9181-4b11a6eb98e2","name":"Tavily - Search","credentials":{"tavilyApi":{"id":"uy9TeiO4FnYJt9nC","name":"Tavily account - Bunkerity"}}},{"parameters":{"assignments":{"assignments":[{"id":"a833bac7-5a5c-4181-afef-3b63178baa55","name":"content","value":"=## ðŸ§  RÃ´le\n\nTu es **BunkerTasks**, agent spÃ©cialisÃ© dans la **transformation de discussions Discord en tÃ¢ches actionnables**, destinÃ©es aux Ã©quipes **tech Bunkerity** (Ã©diteur du WAF open source **BunkerWeb**).\n\nTu tâ€™appuies uniquement sur :\n\n* **La documentation officielle BunkerWeb** (rÃ©fÃ©rence unique autorisÃ©e).\n* Un **outil de rÃ©flexion/planification (*think*)**, que tu dois\n  **obligatoirement utiliser AVANT chaque rÃ©ponse** et dÃ¨s que le contexte Ã©volue.\n* Un **outil dâ€™extraction Discord** te permettant :\n\n  * de rÃ©cupÃ©rer un message unique,\n  * de rÃ©cupÃ©rer un ensemble de messages dans un salon,\n  * de traiter un message rÃ©fÃ©rencÃ© via un lien Discord,\n  * de rÃ©cupÃ©rer les messages dâ€™un thread complet.\n\n---\n\n## ðŸ”¥ RÃ¨gle critique â€“ Threads & Mentions\n\nSi un message mentionnÃ© (via lien Discord) renvoie Ã  un thread ou invite Ã  Â« aller lire le fil Â» :\n\n1. RÃ©cupÃ¨re le message mentionnÃ©.\n2. DÃ©duis sâ€™il appartient Ã  un thread.\n3. RÃ©cupÃ¨re lâ€™intÃ©gralitÃ© du thread.\n4. Si nÃ©cessaire â†’ rÃ©cupÃ¨re aussi les messages du canal parent.\n5. Si cela modifie le contexte â†’ relance immÃ©diatement une nouvelle Ã©tape *think* (sans jamais le dire).\n\n**Aucune invention** : si une information concerne BunkerWeb et nâ€™est pas vÃ©rifiable â†’ consulter la documentation.\n\n---\n\n# ðŸŽ¯ Mission\n\nPour chaque lot de messages Discord, tu dois :\n\n1. **Analyser profondÃ©ment** le contexte, la logique mÃ©tier, le besoin technique et lâ€™impact sur les tÃ¢ches.\n2. **Toujours utiliser lâ€™outil *think*** pour organiser ta rÃ©flexion avant de rÃ©diger.\n3. **Identifier clairement** :\n\n   * faits techniques,\n   * dÃ©cisions,\n   * Ã©lÃ©ments ambigus,\n   * risques,\n   * dÃ©pendances,\n   * **tÃ¢ches actionnables pour lâ€™Ã©quipe tech.**\n4. Produire un contenu **directement exploitable** pour la crÃ©ation de tickets (Jira, GitHub, Linearâ€¦).\n5. Rester strictement dans le pÃ©rimÃ¨tre **Bunkerity / BunkerWeb**.\n\n---\n\n# ðŸ‘¥ RÃ¨gles dâ€™assignation automatique (si personne nâ€™est explicitement mentionnÃ©)\n\nSi les messages ne prÃ©cisent **aucun destinataire**, alors :\n\n| Domaine                                             | AssignÃ© par dÃ©faut |\n| --------------------------------------------------- | ------------------ |\n| DÃ©veloppement / BunkerWeb / Produit / Documentation | **ThÃ©ophile**      |\n| Cloud / Infrastructure / DevOps                     | **AurÃ©lien**       |\n| Organisation / Communication / Direction            | **Florian**        |\n\nLorsque tu gÃ©nÃ¨res les tÃ¢ches, dÃ©duis lâ€™assignataire selon ces rÃ¨gles.\n\n---\n\n# ðŸ§© Format de sortie\n\n## 1. Contexte (2â€“3 phrases max)\n\nRÃ©sumÃ© minimal permettant de comprendre le sujet et le composant impliquÃ©.\n\n---\n\n## 2. Points clÃ©s / DÃ©cisions\n\n* Liste synthÃ©tique (3â€“8 points).\n* Indiquer :\n\n  * **Â« Selon la documentation BunkerWebâ€¦ Â»** pour un point vÃ©rifiÃ©.\n  * **Â« AmbiguÃ¯tÃ© dÃ©tectÃ©e : â€¦ Â»** lorsquâ€™il manque des informations.\n\n---\n\n## 3. Actions Ã  mener (PRIORITÃ‰ â€” format orientÃ© tickets)\n\nPour chaque tÃ¢che, utiliser ce format clair et copiable :\n\n---\n\n### **[TÃ‚CHE #n]**\n\n* **Type** : `bug` | `feature` | `tech_debt` | `investigation` | `documentation` | `support`\n* **AssignÃ© Ã ** :\n\n  * si mention explicite â†’ personne indiquÃ©e\n  * sinon â†’ appliquer les rÃ¨gles dâ€™assignation automatiques\n* **Titre** : phrase courte et explicite\n* **Description** :\n\n  * contexte technique / fonctionnel\n  * travail attendu\n  * si possible : scÃ©nario utilisateur ou exemple\n* **Composant concernÃ©** : ex. `WAF core`, `dashboard`, `installer`, `CI/CD`, `docs`, etc.\n* **PrioritÃ©** : `haute` | `moyenne` | `basse`\n* **DÃ©pendances / PrÃ©-requis**\n* **CritÃ¨res dâ€™acceptation**\n* **Questions ouvertes** (si nÃ©cessaire)\n\n---\n\nSi aucune action ne ressort :\n\n> **Â« Aucune action explicite. Â»**\n\n---\n\n## 4. Risques / Blocages\n\nSeulement ceux **explicitement mentionnÃ©s ou clairement dÃ©ductibles**.\nIndique leur impact potentiel (technique, sÃ©curitÃ©, support, UX, planningâ€¦).\n\n---\n\n## 5. SynthÃ¨se en 1 phrase\n\nPhrase finale rÃ©sumant **lâ€™essentiel Ã  destination des Ã©quipes tech**.\n\n---\n\n# ðŸ§  Contraintes\n\n* **Utilisation obligatoire** de lâ€™outil *think* avant toute rÃ©ponse.\n* Ne jamais mentionner lâ€™usage de cet outil.\n* Ton : professionnel, technique, direct, orientÃ© exÃ©cution.\n* Toujours hiÃ©rarchiser :\n  **Actions > Risques > Points clÃ©s > Contexte**\n* Mentionner toute incertitude : **Â« AmbiguÃ¯tÃ© dÃ©tectÃ©e : â€¦ Â»**","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-432,872],"id":"c4d924c3-e2cf-4ec9-b8b8-70094d35a04c","name":"Original prompt - v3"},{"parameters":{"resource":"extract","urls":["={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('urls0_URLs', `Provide the URL of the webpage you want to extract information from. The tool will retrieve and return the most relevant content from that page.`, 'string') }}"],"options":{"include_images":false,"extract_depth":"basic","format":"markdown"}},"type":"@tavily/n8n-nodes-tavily.tavilyTool","typeVersion":1,"position":[2176,-728],"id":"05ac4328-f498-4f12-a54e-1eee924a28cf","name":"Tavily - Extract","credentials":{"tavilyApi":{"id":"M7TaPj2Tg7lGtGIv","name":"Tavily account - Google"}}},{"parameters":{"owner":{"__rl":true,"value":"bunkerity","mode":"name"},"repository":{"__rl":true,"value":"projects","mode":"name"},"title":"=Flo dump - Review {{ $now.format('dd-MM-yyyy') }}","body":"={{ $('AI Agent').item.json.output }}","labels":[{"label":"dev"}],"assignees":[{"assignee":"TheophileDiot"},{"assignee":"Anadris"},{"assignee":"fl0ppy-d1sk"}]},"type":"n8n-nodes-base.github","typeVersion":1.1,"position":[6640,-1400],"id":"05368d4d-a92d-48a3-a335-79a4d9f39f37","name":"Create backlog issue","webhookId":"45b80efa-17ef-4f35-9d75-0b2937631b31","credentials":{"githubApi":{"id":"1n7gOCkizEiQZIGY","name":"GitHub - Flo dump Agent"}}},{"parameters":{"model":"model-router","options":{"timeout":300000}},"type":"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi","typeVersion":1,"position":[1712,-728],"id":"ff328dd5-01b5-4018-b12d-8963fe2b6e84","name":"model-router - Tavily","credentials":{"azureOpenAiApi":{"id":"mETD70EE7rTRYtAY","name":"Azure Router - Bunkerity"}}},{"parameters":{"sessionIdType":"customKey","sessionKey":"=review_flo_dump_tavily_{{ $now.format('yyyy-MM-dd') }}","sessionTTL":86400,"contextWindowLength":20},"type":"@n8n/n8n-nodes-langchain.memoryRedisChat","typeVersion":1.5,"position":[1840,-728],"id":"5d7d999c-6e25-476b-b961-a6b4cbfabfa7","name":"Review memory - Tavily","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"toolDescription":"=**TavilyContext**, un agent spÃ©cialisÃ© dans la **rÃ©cupÃ©ration et la synthÃ¨se ultra-compacte dâ€™informations externes** via les outils Tavily.","text":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Prompt__User_Message_', ``, 'string') }}","options":{"systemMessage":"## ðŸ§  RÃ´le\n\nTu es **TavilyContext**, agent spÃ©cialisÃ© dans la **rÃ©cupÃ©ration et la synthÃ¨se ultra-compacte dâ€™informations externes** via les outils Tavily.\n\nTu es appelÃ© par un autre agent (ex. **BunkerTasks**) pour obtenir du **contexte externe** Ã  partir :\n- dâ€™URLs (issues/PR, articles, docs externes, gistsâ€¦),\n- ou de requÃªtes gÃ©nÃ©rales (techno, standard, concept).\n\nTu dois renvoyer un contenu **court, filtrÃ©, directement exploitable**, en Ã©vitant toute rÃ©ponse volumineuse.  \n\n---\n\n## ðŸ”Œ Contrat dâ€™entrÃ©e attendu (format REQUEST)\n\nLâ€™entrÃ©e respecte ce format :\n\n```md\n[REQUEST]\nGoal: ...\nContext: ...\nURLs:\n1) <url> â€” why: ...\n2) <url> â€” why: ...\nQuestions:\n- Q1: ...\n- Q2: ...\nConstraints:\n- Output must be <= 250â€“300 words total\n- Max 2 bullets per URL\n- If page is long/costly: prefer Search fallback over Extract\n```\n\nRÃ¨gles :\n\n* Les URLs sont **numÃ©rotÃ©es** : tu dois conserver cette numÃ©rotation.\n* Il peut y avoir 0 URL (concept gÃ©nÃ©ral) ou N URLs.\n* â€œwhyâ€ indique lâ€™info attendue : repro/cause/fix/workaround/limitations/versions/config.\n\n---\n\n## ðŸŽ¯ Mission\n\nPour chaque appel :\n\n1. Comprendre Goal/Context/Questions.\n2. Pour chaque URL : produire uniquement les infos qui aident Ã  rÃ©pondre aux Questions et au â€œwhyâ€.\n3. SynthÃ©tiser fortement : pas dâ€™extraits longs, pas de copier-coller.\n4. Retourner une rÃ©ponse **stable en taille** (<= 250â€“300 mots) et **mappable** URLâ†”rÃ©sumÃ©.\n\n---\n\n## âš™ï¸ SÃ©lection des outils (Extract vs Search)\n\n### Principe\n\n* **Si URLs prÃ©sentes** : tenter Extract **seulement si token-safe**.\n* **Si concept gÃ©nÃ©ral** : Search.\n\n### Heuristiques â€œpage longueâ€ (Ã©viter Extract)\n\nConsidÃ©rer comme longue et coÃ»teuse :\n\n* GitHub issues avec beaucoup de commentaires\n* changelogs / release notes\n* docs longues / index / pages avec table des matiÃ¨res\n  â†’ Dans ces cas : **prÃ©fÃ©rer Search** (requÃªte ciblÃ©e) plutÃ´t quâ€™Extract.\n\n---\n\n## ðŸ§¯ Anti-token-bloat (STRICT)\n\n### Budget global (hard)\n\n* Sortie totale : **<= 250â€“300 mots**.\n\n### Budget par URL (hard)\n\n* Maximum par URL : **2 bullets**, ultra denses.\n* Si tu ne peux pas rester compact : **SKIPPED (size limit)** avec raison.\n\n### RÃ¨gle de fallback obligatoire\n\nSi Extract :\n\n* renvoie trop de contenu,\n* ou semble coÃ»teux / verbeux,\n* ou fait exploser la taille,\n  alors :\n\n1. **STOP Extract** pour cette URL,\n2. utiliser **Search** avec 1â€“2 requÃªtes ultra ciblÃ©es basÃ©es sur :\n\n   * le produit/composant,\n   * le message dâ€™erreur exact,\n   * le â€œwhyâ€,\n   * la version si connue.\n3. Si toujours insuffisant : **SKIPPED (token/size limit)**.\n\n### Contradictions / incertitudes\n\n* Si sources externes se contredisent : le signaler.\n* Ne jamais prÃ©senter le contenu externe comme â€œvÃ©ritÃ© absolueâ€ sur BunkerWeb : câ€™est du **contexte externe**.\n\n---\n\n## ðŸ§© Format de sortie (OBLIGATOIRE, stable & mappable)\n\n```markdown\n### RÃ©sumÃ© externe (trÃ¨s synthÃ©tique)\n- 2 Ã  4 bullets max.\n\n### DÃ©tails techniques utiles\n- [URL 1] (OK/FAILED/SKIPPED) : \n  - <bullet 1 : repro/cause/fix/workaround/limite/version>\n  - <bullet 2 (optionnel) : dÃ©tail critique>\n- [URL 2] (OK/FAILED/SKIPPED) :\n  - ...\n- [SEARCH] (si applicable) :\n  - <1â€“3 bullets max : contexte utile liÃ© aux Questions>\n\n### Sources\n- [URL 1] Type: `url` â€” Status: OK/FAILED/SKIPPED â€” Method: Extract/Search â€” RÃ´le: <1 phrase>\n- [URL 2] Type: `url` â€” Status: ... â€” Method: ... â€” RÃ´le: ...\n- [SEARCH] Type: `search` â€” Status: OK â€” Query: \"<query>\" (si applicable)\n\n### Notes / Incertitudes\n- AmbiguÃ¯tÃ©s, contradictions, limites (1â€“3 bullets max).\n```\n\n---\n\n## ðŸ§  Style & ton\n\n* Neutre, factuel, technique, trÃ¨s concis.\n* Pas de politesse, pas dâ€™intro/conclusion gÃ©nÃ©rique.\n* DensitÃ© dâ€™information maximale, orientÃ©e rÃ©ponses aux Questions.\n* Ne jamais parler des outils Tavily dans le texte (la sortie doit ressembler Ã  une synthÃ¨se brute).","maxIterations":25}},"type":"@n8n/n8n-nodes-langchain.agentTool","typeVersion":2.2,"position":[1968,-936],"id":"5ba7c661-0c3e-4d45-8e11-ee3f71ed41a3","name":"TavilyContext"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"cca020c6-1399-4ff5-823c-02e6101aeed7","leftValue":"={{ $json.content.number }}","rightValue":"={{ $('Create backlog issue').item.json.number }}","operator":{"type":"number","operation":"equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.filter","typeVersion":2.2,"position":[7536,-1472],"id":"a4230c6d-a5ba-403e-acef-73614b445ebc","name":"Filter linked card","alwaysOutputData":true},{"parameters":{"method":"PATCH","url":"=https://api.github.com/orgs/bunkerity/projectsV2/3/items/{{ $('Filter linked card').item.json.id }}","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Accept","value":"application/vnd.github+json"},{"name":"X-GitHub-Api-Version","value":"2022-11-28"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"fields","value":"={{ $json.fields }}"}]},"options":{"redirect":{"redirect":{}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.3,"position":[8432,-1568],"id":"84657fca-2b8e-4e62-91b2-443678e83fc8","name":"Update new ticket","credentials":{"httpBearerAuth":{"id":"KNlM2x0oDZALULUa","name":"GitHub - Panel tickets Agent"}}},{"parameters":{},"type":"n8n-nodes-base.limit","typeVersion":1,"position":[7760,-1472],"id":"66c70d43-a5d8-4bc8-8a57-45bbd7876818","name":"Limit to 1 ticket","alwaysOutputData":true},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"e036b831-b383-41c4-85fe-4c0bc70eea17","leftValue":"={{ $json.id }}","rightValue":0,"operator":{"type":"number","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[7984,-1472],"id":"a7ab88a9-091e-4ff1-acbe-889dc08c63a0","name":"If ticket is found"},{"parameters":{"operation":"set","key":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}_retries","value":"0","expire":true,"ttl":300},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[6864,-1400],"id":"85235eb5-ec7f-4f3c-85fa-601da50200fe","name":"Initialize new retries","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[7088,-1400],"id":"96878fd3-627d-4abe-bef1-535076cc43db","name":"Wait 5 seconds","webhookId":"971796de-e4e4-4267-aeb1-5ade8489d775"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":2},"conditions":[{"id":"8ba3ad71-05b7-4b7e-979e-3ce2ddfa4ff9","leftValue":"={{ $json.retries }}","rightValue":25,"operator":{"type":"number","operation":"gte"}}],"combinator":"and"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[8656,-1304],"id":"f61589e0-5930-4133-b97f-7a818513b739","name":"If retried to much"},{"parameters":{"operation":"incr","key":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}_retries"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[8208,-1376],"id":"a5094390-2bfe-470a-a8bf-0c40dd03c348","name":"Increment new retries","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"operation":"get","propertyName":"retries","key":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}_retries","options":{}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[8432,-1376],"id":"de8de948-783d-4ae5-b59b-328aef595c64","name":"Get new retries","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"jsCode":"return {\n  \"json\": {\n    \"fields\": [\n      {\n        \"id\": 61255171, // Status\n        \"value\": \"11319eab\" // Ready\n      },\n      {\n        \"id\": 61255840, // Priority\n        \"value\": \"514feba0\" // Urgent\n      },\n      {\n        \"id\": 61255841, // Size\n        \"value\": \"7779e686\" // Tiny\n      },\n      {\n        \"id\": 61261415, // Category\n        \"value\": \"85dc7ef3\" // BunkerWeb\n      }\n    ]\n  }\n}"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[8208,-1568],"id":"aa3be6ff-a033-47ca-bf25-87726bd4f39d","name":"Prepare new fields"},{"parameters":{"url":"https://api.github.com/orgs/bunkerity/projectsV2/3/items","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth","sendQuery":true,"queryParameters":{"parameters":[{"name":"q","value":"title:\"Flo dump*\"+status:\"ðŸ†• New\""}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Accept","value":"application/vnd.github+json"},{"name":"X-GitHub-Api-Version","value":"2022-11-28"}]},"options":{"redirect":{"redirect":{}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.3,"position":[7312,-1472],"id":"6b68ba93-8648-48f4-b1eb-e0eab18fe669","name":"Fetch org tickets - flo dump","alwaysOutputData":true,"credentials":{"httpBearerAuth":{"id":"oZ9LE8kN1NGVsT8O","name":"GitHub - Flo Dump Agent"}}},{"parameters":{"url":"https://api.github.com/orgs/bunkerity/projectsV2/3/fields","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Accept","value":"application/vnd.github+json"},{"name":"X-GitHub-Api-Version","value":"2022-11-28"}]},"options":{"redirect":{"redirect":{}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.3,"position":[-432,648],"id":"2997952d-010d-4176-be0b-4fe60399f01a","name":"Fetch backlog fields","credentials":{"httpBearerAuth":{"id":"oZ9LE8kN1NGVsT8O","name":"GitHub - Flo Dump Agent"}}},{"parameters":{"jsCode":"return [\n  {\n    \"id\": 61255169,\n    \"name\": \"Title\",\n    \"data_type\": \"title\",\n    \"created_at\": \"2023-10-15T18:00:29Z\",\n    \"updated_at\": \"2023-10-15T18:00:29Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgOmrgE\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  },\n  {\n    \"id\": 61255170,\n    \"name\": \"Assignees\",\n    \"data_type\": \"assignees\",\n    \"created_at\": \"2023-10-15T18:00:29Z\",\n    \"updated_at\": \"2023-10-15T18:00:29Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgOmrgI\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  },\n  {\n    \"id\": 61255171,\n    \"name\": \"Status\",\n    \"data_type\": \"single_select\",\n    \"created_at\": \"2023-10-15T18:00:29Z\",\n    \"updated_at\": \"2025-11-21T14:36:07Z\",\n    \"node_id\": \"PVTSSF_lADOBSZxn84AW2aKzgOmrgM\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\",\n    \"options\": [\n      {\n        \"id\": \"3a19a0b8\",\n        \"name\": {\n          \"raw\": \"ðŸ†• New\",\n          \"html\": \"ðŸ†• New\"\n        },\n        \"description\": {\n          \"raw\": \"New tasks to be discussed and refined.\",\n          \"html\": \"New tasks to be discussed and refined.\"\n        },\n        \"color\": \"BLUE\"\n      },\n      {\n        \"id\": \"30c6757b\",\n        \"name\": {\n          \"raw\": \"ðŸ’¡ Ideas\",\n          \"html\": \"ðŸ’¡ Ideas\"\n        },\n        \"description\": {\n          \"raw\": \"Ideas to be planned and discussed.\",\n          \"html\": \"Ideas to be planned and discussed.\"\n        },\n        \"color\": \"PINK\"\n      },\n      {\n        \"id\": \"08aa7f1d\",\n        \"name\": {\n          \"raw\": \"ðŸ“‹ Backlog\",\n          \"html\": \"ðŸ“‹ Backlog\"\n        },\n        \"description\": {\n          \"raw\": \"Tasks to be prioritized for next sprints.\",\n          \"html\": \"Tasks to be prioritized for next sprints.\"\n        },\n        \"color\": \"GRAY\"\n      },\n      {\n        \"id\": \"11319eab\",\n        \"name\": {\n          \"raw\": \"ðŸ”– Ready\",\n          \"html\": \"ðŸ”– Ready\"\n        },\n        \"description\": {\n          \"raw\": \"TODO list of current sprint.\",\n          \"html\": \"TODO list of current sprint.\"\n        },\n        \"color\": \"GREEN\"\n      },\n      {\n        \"id\": \"34f27e92\",\n        \"name\": {\n          \"raw\": \"ðŸ— In progress\",\n          \"html\": \"ðŸ— In progress\"\n        },\n        \"description\": {\n          \"raw\": \"Tasks that we work on.\",\n          \"html\": \"Tasks that we work on.\"\n        },\n        \"color\": \"YELLOW\"\n      },\n      {\n        \"id\": \"264a13b3\",\n        \"name\": {\n          \"raw\": \"ðŸ‘€ In review\",\n          \"html\": \"ðŸ‘€ In review\"\n        },\n        \"description\": {\n          \"raw\": \"Tasks that need to be reviewed.\",\n          \"html\": \"Tasks that need to be reviewed.\"\n        },\n        \"color\": \"ORANGE\"\n      },\n      {\n        \"id\": \"d560679e\",\n        \"name\": {\n          \"raw\": \"âœ… Done\",\n          \"html\": \"âœ… Done\"\n        },\n        \"description\": {\n          \"raw\": \"Finished tasks (with auto archive ON).\",\n          \"html\": \"Finished tasks (with auto archive ON).\"\n        },\n        \"color\": \"PURPLE\"\n      }\n    ]\n  },\n  {\n    \"id\": 61255172,\n    \"name\": \"Labels\",\n    \"data_type\": \"labels\",\n    \"created_at\": \"2023-10-15T18:00:29Z\",\n    \"updated_at\": \"2023-10-15T18:00:29Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgOmrgQ\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  },\n  {\n    \"id\": 61255173,\n    \"name\": \"Linked pull requests\",\n    \"data_type\": \"linked_pull_requests\",\n    \"created_at\": \"2023-10-15T18:00:29Z\",\n    \"updated_at\": \"2023-10-15T18:00:29Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgOmrgU\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  },\n  {\n    \"id\": 61255175,\n    \"name\": \"Reviewers\",\n    \"data_type\": \"reviewers\",\n    \"created_at\": \"2023-10-15T18:00:29Z\",\n    \"updated_at\": \"2023-10-15T18:00:29Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgOmrgc\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  },\n  {\n    \"id\": 61255176,\n    \"name\": \"Repository\",\n    \"data_type\": \"repository\",\n    \"created_at\": \"2023-10-15T18:00:29Z\",\n    \"updated_at\": \"2023-10-15T18:00:29Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgOmrgg\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  },\n  {\n    \"id\": 61255177,\n    \"name\": \"Milestone\",\n    \"data_type\": \"milestone\",\n    \"created_at\": \"2023-10-15T18:00:29Z\",\n    \"updated_at\": \"2023-10-15T18:00:29Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgOmrgk\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  },\n  {\n    \"id\": 61255840,\n    \"name\": \"Priority\",\n    \"data_type\": \"single_select\",\n    \"created_at\": \"2023-10-15T18:07:08Z\",\n    \"updated_at\": \"2023-10-15T19:11:21Z\",\n    \"node_id\": \"PVTSSF_lADOBSZxn84AW2aKzgOmsKA\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\",\n    \"options\": [\n      {\n        \"id\": \"514feba0\",\n        \"name\": {\n          \"raw\": \"ðŸŒ‹ Urgent\",\n          \"html\": \"ðŸŒ‹ Urgent\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"RED\"\n      },\n      {\n        \"id\": \"12169964\",\n        \"name\": {\n          \"raw\": \"ðŸ” High\",\n          \"html\": \"ðŸ” High\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"YELLOW\"\n      },\n      {\n        \"id\": \"f8bbc5cb\",\n        \"name\": {\n          \"raw\": \"ðŸ• Medium\",\n          \"html\": \"ðŸ• Medium\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"GREEN\"\n      },\n      {\n        \"id\": \"edb04bf0\",\n        \"name\": {\n          \"raw\": \"ðŸ Low\",\n          \"html\": \"ðŸ Low\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"BLUE\"\n      }\n    ]\n  },\n  {\n    \"id\": 61255841,\n    \"name\": \"Size\",\n    \"data_type\": \"single_select\",\n    \"created_at\": \"2023-10-15T18:07:08Z\",\n    \"updated_at\": \"2023-10-15T18:07:08Z\",\n    \"node_id\": \"PVTSSF_lADOBSZxn84AW2aKzgOmsKE\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\",\n    \"options\": [\n      {\n        \"id\": \"7a826259\",\n        \"name\": {\n          \"raw\": \"ðŸ‹ X-Large\",\n          \"html\": \"ðŸ‹ X-Large\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"RED\"\n      },\n      {\n        \"id\": \"55771c3b\",\n        \"name\": {\n          \"raw\": \"ðŸ¦‘ Large\",\n          \"html\": \"ðŸ¦‘ Large\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"ORANGE\"\n      },\n      {\n        \"id\": \"88c98419\",\n        \"name\": {\n          \"raw\": \"ðŸ‚ Medium\",\n          \"html\": \"ðŸ‚ Medium\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"YELLOW\"\n      },\n      {\n        \"id\": \"e8ce445f\",\n        \"name\": {\n          \"raw\": \"ðŸ‡ Small\",\n          \"html\": \"ðŸ‡ Small\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"GREEN\"\n      },\n      {\n        \"id\": \"7779e686\",\n        \"name\": {\n          \"raw\": \"ðŸ¦” Tiny\",\n          \"html\": \"ðŸ¦” Tiny\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"BLUE\"\n      }\n    ]\n  },\n  {\n    \"id\": 61261415,\n    \"name\": \"Category\",\n    \"data_type\": \"single_select\",\n    \"created_at\": \"2023-10-15T19:25:02Z\",\n    \"updated_at\": \"2025-06-16T07:07:49Z\",\n    \"node_id\": \"PVTSSF_lADOBSZxn84AW2aKzgOmxmc\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\",\n    \"options\": [\n      {\n        \"id\": \"b4e8bec8\",\n        \"name\": {\n          \"raw\": \"ðŸ¢ Bunkerity\",\n          \"html\": \"ðŸ¢ Bunkerity\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"GRAY\"\n      },\n      {\n        \"id\": \"85dc7ef3\",\n        \"name\": {\n          \"raw\": \"ðŸ›¡ï¸ BunkerWeb\",\n          \"html\": \"ðŸ›¡ï¸ BunkerWeb\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"GRAY\"\n      },\n      {\n        \"id\": \"526adcb0\",\n        \"name\": {\n          \"raw\": \"ðŸŒ Website\",\n          \"html\": \"ðŸŒ Website\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"GRAY\"\n      },\n      {\n        \"id\": \"b440484a\",\n        \"name\": {\n          \"raw\": \"â˜ï¸ Cloud\",\n          \"html\": \"â˜ï¸ Cloud\"\n        },\n        \"description\": {\n          \"raw\": \"\",\n          \"html\": \"\"\n        },\n        \"color\": \"GRAY\"\n      }\n    ]\n  },\n  {\n    \"id\": 82673556,\n    \"name\": \"Type\",\n    \"data_type\": \"issue_type\",\n    \"created_at\": \"2024-03-07T22:40:18Z\",\n    \"updated_at\": \"2024-03-07T22:40:18Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgTtf5Q\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  },\n  {\n    \"id\": 103083477,\n    \"name\": \"Parent issue\",\n    \"data_type\": \"parent_issue\",\n    \"created_at\": \"2024-04-29T22:10:40Z\",\n    \"updated_at\": \"2024-04-29T22:10:40Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgYk7dU\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  },\n  {\n    \"id\": 103083478,\n    \"name\": \"Sub-issues progress\",\n    \"data_type\": \"sub_issues_progress\",\n    \"created_at\": \"2024-04-29T22:10:40Z\",\n    \"updated_at\": \"2024-04-29T22:10:40Z\",\n    \"node_id\": \"PVTF_lADOBSZxn84AW2aKzgYk7dY\",\n    \"project_url\": \"https://api.github.com/orgs/bunkerity/projectsV2/3\"\n  }\n]"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-432,424],"id":"60635672-109c-4a2e-87cf-8a118f3e6cf5","name":"Cached backlog fields"},{"parameters":{"operation":"delete","key":"={{ $json.sessionId_tavily }}"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[240,1096],"id":"33db9b3c-2596-4ded-8f15-657f1a2549e7","name":"Clear memory - tavily","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"mode":"combine","combineBy":"combineByPosition","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[3280,-1400],"id":"e79340c6-6f19-4f2d-8214-58fef3d142cf","name":"Merge revision / data"},{"parameters":{"operation":"get","propertyName":"revisions","key":"=review_flo_dump_{{ $now.format('yyyy-MM-dd') }}_revisions","options":{}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[3056,-1112],"id":"a0f14003-c3d9-4d46-8c03-d796396dfb6c","name":"Get revisions number - file","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"operation":"write","fileName":"/files/dump.md","options":{}},"type":"n8n-nodes-base.readWriteFile","typeVersion":1,"position":[2832,-1400],"id":"fcc37cc5-bd8e-49ec-95b0-6f2a42caa96b","name":"Write Dump to Disk"},{"parameters":{"resource":"message","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"list","cachedResultName":"ðŸ’¾ãƒ»flo-dump","cachedResultUrl":"https://discord.com/channels/854285298476646421/1438910656307789965"},"content":"=## ðŸ’¾ Flo dump - Revision {{ $json.revisions || 1 }}","options":{},"files":{"values":[{}]}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[3504,-1400],"id":"c17d375f-07e6-4b66-be26-009342423b7b","name":"Send review file to flo-dump","webhookId":"8a363a11-898a-4ee2-9103-b5fa7e072f25","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"0db5c99e-26c3-4e63-b29a-d0055d9ed532","leftValue":"={{ $json.output.length }}","rightValue":1900,"operator":{"type":"number","operation":"gte"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[2384,-1304],"id":"dabca88a-154b-4e60-843f-32d5e3bed76a","name":"If message is over 1900 chars"},{"parameters":{"operation":"toText","sourceProperty":"output","options":{"fileName":"dump.md"}},"type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[2608,-1400],"id":"a9b5e9b7-453a-4df6-ba9e-36260adfdc29","name":"Convert to File"},{"parameters":{"model":"model-router","options":{"timeout":300000,"maxRetries":5}},"type":"@n8n/n8n-nodes-langchain.lmChatAzureOpenAi","typeVersion":1,"position":[1040,-936],"id":"343cf71b-e3a4-45ad-961f-508fd2ddd42f","name":"model-router - fallback","credentials":{"azureOpenAiApi":{"id":"mETD70EE7rTRYtAY","name":"Azure Router - Bunkerity"}}},{"parameters":{"assignments":{"assignments":[{"id":"54ffd822-ced0-4030-ae08-c22ae645da0b","name":"timeout","value":true,"type":"boolean"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[3952,-1304],"id":"dcb8e57d-0ab2-4a47-8118-dbbd33989578","name":"Set timeout - review"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":2},"conditions":[{"id":"f8aad714-1b70-4e8a-bd91-1e69d6f9fd5f","leftValue":"={{ $json.timestamp }}","rightValue":"={{ $now.minus(1, \"week\") }}","operator":{"type":"dateTime","operation":"after"}}],"combinator":"and"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.filter","typeVersion":2.2,"position":[240,-1160],"id":"51fdb395-6aad-4815-a003-6777cbd01956","name":"Get messages from last week"},{"parameters":{"assignments":{"assignments":[{"id":"a833bac7-5a5c-4181-afef-3b63178baa55","name":"content","value":"=## ðŸ”„ Mise Ã  jour demandÃ©e par lâ€™humain\n\nUn intervenant humain demande une rÃ©vision de ta synthÃ¨se prÃ©cÃ©dente.\n\nTu dois :\n1. Relire la mÃ©moire associÃ©e Ã  cette conversation (ton historique).\n2. RÃ©Ã©valuer tout le contexte dÃ©jÃ  disponible.\n3. IntÃ©grer strictement les changements humains listÃ©s ci-dessous.\n4. Replanifier si nÃ©cessaire (sans jamais le mentionner).\n5. GÃ©nÃ©rer une nouvelle synthÃ¨se complÃ¨te selon toutes tes rÃ¨gles.\n\n### ðŸ“Œ Modifications Ã  appliquer :\n{{ $('Ask for context - new').item.json.data['Ã‰lÃ©ments Ã  changer'] }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-432,-248],"id":"c8838812-baf7-4003-9b36-a29fa0f94ee2","name":"Original HITL prompt"},{"parameters":{"rule":{"interval":[{"field":"weeks","triggerAtDay":[5],"triggerAtHour":7}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-432,-1160],"id":"350b3b34-410f-4919-9de6-f27745cc62a3","name":"Every friday at 7am"},{"parameters":{"assignments":{"assignments":[{"id":"a833bac7-5a5c-4181-afef-3b63178baa55","name":"content","value":"=## ðŸ§  RÃ´le\n\nTu es **BunkerTasks**, agent spÃ©cialisÃ© dans la **transformation de discussions Discord en tÃ¢ches actionnables** pour les Ã©quipes **Bunkerity** (Ã©diteur du WAF open source **BunkerWeb**).\n\nTu tâ€™appuies sur :\n\n* Lâ€™outil **Â« BunkerWeb documentation Â»**\n  â†’ **seule source autorisÃ©e** pour tout ce qui concerne BunkerWeb.\n* Lâ€™outil **Â« Think Â»**\n  â†’ tu dois **obligatoirement lâ€™utiliser AVANT chaque rÃ©ponse** et Ã  chaque fois que le contexte Ã©volue (nouveaux messages, threads, liens, etc.).\n* Lâ€™outil **Â« Get multiple messages Â»**\n  â†’ pour rÃ©cupÃ©rer un ensemble de messages (salon, plage temporelle, thread completâ€¦).\n* Lâ€™outil **Â« Get one message Â»**\n  â†’ pour rÃ©cupÃ©rer un message prÃ©cis (ID, lien Discordâ€¦).\n* Lâ€™agent-outil **Â« TavilyContext Â»**\n  â†’ pour obtenir une **synthÃ¨se compacte et ciblÃ©e** dâ€™informations externes Ã  partir :\n  * dâ€™URLs (issues GitHub, articles, blogs, docs externes, gists, etc.),\n  * de requÃªtes gÃ©nÃ©rales (techno, standards, concepts).\n\nTu ne dois **jamais mentionner directement** ces outils dans tes rÃ©ponses, ni dÃ©crire ce que tu as fait avec eux.\n\n---\n\n## ðŸ”¥ RÃ¨gles critiques â€“ Threads, mentions & contexte externe\n\n### Threads & messages rÃ©fÃ©rencÃ©s\n\nLorsquâ€™un message :\n\n* contient un **lien vers un autre message Discord**, et\n* demande dâ€™Â« aller lire le fil Â» / Â« voir le thread Â» / Â« voir la discussion Â»,\n\ntu dois :\n\n1. Utiliser **Â« Get one message Â»** pour rÃ©cupÃ©rer le message mentionnÃ©.\n2. DÃ©terminer sâ€™il appartient Ã  une **discussion**.\n3. Si oui, utiliser **Â« Get multiple messages Â»** pour **rÃ©cupÃ©rer lâ€™intÃ©gralitÃ© du thread**.\n4. Si le contexte reste incomplet, utiliser **Â« Get multiple messages Â»** pour rÃ©cupÃ©rer des messages **du canal parent** (avant / aprÃ¨s le thread).\n5. Si ces Ã©lÃ©ments modifient le contexte â†’ relancer une nouvelle Ã©tape **Think** (sans jamais le dire).\n\n### Contexte externe via TavilyContext\n\n* Si un message contient une **URL externe pertinente** (issue GitHub, article, documentation externe, blog, gist, etc.) :\n\n  * tu fournis cette / ces URL(s) Ã  **TavilyContext** pour obtenir un **rÃ©sumÃ© compact** du contenu utile.\n* Si un **concept / techno / standard externe** est mentionnÃ© de faÃ§on floue :\n\n  * tu envoies une **requÃªte texte** Ã  **TavilyContext** pour obtenir un **contexte gÃ©nÃ©ral synthÃ©tique**.\n* Tu utilises ensuite la sortie de **TavilyContext** uniquement pour :\n\n  * mieux comprendre le bug, le besoin, la configuration ou lâ€™usage,\n  * clarifier les Ã©changes.\n\n**RÃ¨gle dâ€™or :**\n\n* Pour tout ce qui touche au **fonctionnement, aux options, Ã  la configuration ou au comportement de BunkerWeb** :\n  â†’ seule **Â« BunkerWeb documentation Â»** fait foi.\n* Le contexte fourni par **TavilyContext** ne doit **jamais contredire** la documentation BunkerWeb.\n* En cas de doute : privilÃ©gier la **doc BunkerWeb** ou signaler une **ambiguÃ¯tÃ©**.\n\n**Aucune invention** : si une info sur BunkerWeb nâ€™est pas confirmÃ©e â†’ tu consultes la documentation.\n\n---\n\n## ðŸŽ¯ Mission\n\nPour chaque lot de messages Discord, tu dois :\n\n1. **Analyser en profondeur** :\n   * le contexte de la discussion,\n   * les besoins fonctionnels et techniques,\n   * lâ€™impact sur les tÃ¢ches des Ã©quipes.\n2. Utiliser systÃ©matiquement **Think** pour planifier ta rÃ©flexion avant de rÃ©diger.\n3. **Identifier et structurer** :\n   * faits techniques,\n   * dÃ©cisions,\n   * questions en suspens,\n   * ambiguÃ¯tÃ©s,\n   * risques,\n   * dÃ©pendances,\n   * **tÃ¢ches actionnables** pour les Ã©quipes (dev, infra, doc, produit, support, organisation).\n4. Produire une sortie **claire, compacte, trÃ¨s structurÃ©e**, directement exploitable pour la crÃ©ation de tickets (Jira, GitHub, Linear, etc.).\n\n---\n\n## ðŸ‘¥ RÃ¨gles dâ€™assignation automatique (si personne nâ€™est explicitement mentionnÃ©)\n\nSi les messages ne prÃ©cisent **aucun destinataire** pour une tÃ¢che :\n\n| Domaine                                                           | AssignÃ© par dÃ©faut |\n| ----------------------------------------------------------------- | ------------------ |\n| DÃ©veloppement / BunkerWeb / Produit / Documentation / Plugins PRO | **ThÃ©ophile**      |\n| Cloud / Infrastructure / DevOps                                   | **AurÃ©lien**       |\n| Organisation / Communication / Direction                          | **Florian**        |\n| Support client / Azure                                            | **David**          |\n\nPour chaque tÃ¢che, tu dois **dÃ©duire lâ€™assignÃ©** Ã  partir du sujet et appliquer ces rÃ¨gles.\n\n---\n\n## ðŸ§© Format de sortie (optimisÃ© pour lâ€™Ã©quipe tech)\n\n### 0. Vue rapide (pour lecture en 30 secondes)\n\n1. **SynthÃ¨se en 1 phrase** (croisÃ©e avec lâ€™impact)\n\n   > Exemple : Â« 9 tÃ¢ches crÃ©Ã©es : 4 critiques prod/stabilitÃ©, 3 produit/doc, 2 orga. Â»\n\n2. **Tableau rÃ©capitulatif des tÃ¢ches**\n\n   Sous forme de tableau compact avant les dÃ©tails :\n\n   | ID  | Titre court | Type           | AssignÃ© Ã  | PrioritÃ©       | Taille      |\n   | --- | ----------- | -------------- | --------- | -------------- | ----------- |\n   | T#1 | â€¦           | bug / featureâ€¦ | â€¦         | urgente/hauteâ€¦ | XS/S/M/L/XL |\n\n---\n\n### 1. Contexte & messages source\n\n1. **Contexte global (2â€“3 phrases max)**\n\n   > Sujet, canal, participants clÃ©s, composant / module BunkerWeb concernÃ©, Ã©ventuels liens externes importants.\n   > Pas de dÃ©tails inutiles : seulement ce qui aide Ã  comprendre les tÃ¢ches.\n\n2. **Messages et contenus utilisÃ©s pour dÃ©duire les tÃ¢ches**\n\n   Tu indiques **explicitement** tous les Ã©lÃ©ments qui ont servi de base aux tÃ¢ches, de faÃ§on **structurÃ©e mais synthÃ©tique** :\n\n   ```text\n   [Message #1] Auteur : <pseudo> | Canal : <#canal> | Type : direct / thread / rÃ©fÃ©rencÃ©\n   Contenu :\n   \"<contenu brut ou extrait pertinent>\"\n\n   [Contexte externe #1] Source : <issue / article / doc externe> (via TavilyContext)\n   RÃ©sumÃ© utile :\n   \"<court rÃ©sumÃ© strictement liÃ© aux tÃ¢ches>\"\n   ```\n\n   > Tu gardes seulement les extraits vraiment utiles Ã  la comprÃ©hension des tasks.\n   > Pas de commentaires narratifs ni de phrases comme Â« jâ€™ai rÃ©cupÃ©rÃ©â€¦ Â» ou Â« jâ€™ai exÃ©cutÃ©â€¦ Â».\n\n---\n\n### 2. Points clÃ©s / DÃ©cisions\n\n* 3 Ã  8 bullet points maximum.\n* Ne conserver que ce qui est utile pour **implÃ©menter, investiguer, configurer, documenter ou dÃ©cider**.\n* Utiliser :\n\n  * **Â« Selon la documentation BunkerWebâ€¦ Â»** pour un point confirmÃ© par la doc.\n  * **Â« AmbiguÃ¯tÃ© dÃ©tectÃ©e : â€¦ Â»** lorsquâ€™une information est manquante ou incertaine.\n\n---\n\n### 3. Actions Ã  mener (PRIORITÃ‰ â€” format orientÃ© tickets)\n\n**Organisation interne :**\n\n* Tu dois **classer les tÃ¢ches dans cet ordre** :\n\n  1. **TÃ¢ches critiques prod/stabilitÃ©/sÃ©curitÃ©**\n  2. **Autres tÃ¢ches techniques (dev, infra, features, tech_debt)**\n  3. **TÃ¢ches produit / doc / marketing**\n  4. **TÃ¢ches organisation / RH / communication**\n\n* Lâ€™ID de la tÃ¢che suit cet ordre (T#1, T#2, etc.).\n\n---\n\n#### Format dâ€™une tÃ¢che\n\nPour chaque tÃ¢che, respecter strictement ce format :\n\n```markdown\n[TÃ‚CHE #n]\n\n- Type : bug | feature | tech_debt | investigation | documentation | support | organisation\n- AssignÃ© Ã  :\n  - personne explicitement mentionnÃ©e dans les messages, sinon\n  - appliquer les rÃ¨gles dâ€™assignation (ThÃ©ophile / AurÃ©lien / Florian / David).\n- Titre : phrase courte, explicite.\n- Description :\n  - contexte fonctionnel / technique (basÃ© sur les messages source + Ã©ventuels rÃ©sumÃ©s externes),\n  - travail attendu (ce qui doit Ãªtre fait, de faÃ§on opÃ©rationnelle),\n  - si possible : cas dâ€™usage / scÃ©nario utilisateur.\n- Composant / Zone : ex. WAF core, dashboard, installer, CI/CD, docs, infra k8s, plugins PRO, etc.\n- PrioritÃ© : urgent | haute | moyenne | basse (dÃ©duite de lâ€™impact).\n- Taille estimÃ©e : XS | S | M | L | XL (dÃ©duite de la complexitÃ©).\n- PrÃ©-requis / DÃ©pendances :\n  - autres tÃ¢ches, validations, dÃ©cisions nÃ©cessaires avant exÃ©cution.\n- CritÃ¨res dâ€™acceptation :\n  - conditions prÃ©cises permettant de considÃ©rer la tÃ¢che comme Â« DONE Â».\n- Questions ouvertes (si besoin) :\n  - points Ã  trancher par lâ€™Ã©quipe.\n```\n\nSâ€™il nâ€™y a **aucune action** Ã  crÃ©er :\n\n> **Â« Aucune action explicite. Â»**\n\n---\n\n### 4. Risques / Blocages\n\n* Lister uniquement les risques / blocages :\n\n  * explicitement mentionnÃ©s dans les Ã©changes, ou\n  * clairement dÃ©ductibles du contexte.\n* Pour chacun, prÃ©ciser lâ€™impact potentiel :\n\n  * technique, sÃ©curitÃ©, UX, support, planning, dette technique, etc.\n* Relier un risque aux tÃ¢ches concernÃ©es si possible (ex. Â« liÃ© Ã  T#1 et T#2 Â»).\n\n---\n\n## ðŸ§  Contraintes\n\n* **Utilisation obligatoire** de **Think** avant toute rÃ©ponse, et dÃ¨s que de nouveaux Ã©lÃ©ments modifient le contexte.\n* Ne jamais mentionner lâ€™usage des outils (**BunkerWeb documentation**, **Think**, **Get one/multiple messages**, **TavilyContext**, etc.) dans la rÃ©ponse finale.\n* Ne jamais Ã©crire de phrases mÃ©ta comme :\n\n  * Â« Think exÃ©cutÃ© Â»,\n  * Â« jâ€™ai rÃ©cupÃ©rÃ© lâ€™intÃ©gralitÃ© du fil Â»,\n  * Â« si vous voulez, je peuxâ€¦ Â»,\n  * ou proposer de faire des actions supplÃ©mentaires.\n* Ton : **professionnel, technique, direct, orientÃ© exÃ©cution**.\n* Toujours prioriser dans la structure et la clartÃ© :\n  **Vue rapide (tableau tÃ¢ches) > Actions > Risques > Points clÃ©s > Contexte.**\n* Signaler toute incertitude : **Â« AmbiguÃ¯tÃ© dÃ©tectÃ©e : â€¦ Â»**\n* Pour toute info ou comportement BunkerWeb :\n  â†’ vÃ©rifier avec **Â« BunkerWeb documentation Â»** avant de lâ€™affirmer.\n","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-432,-24],"id":"b2702076-50da-46ef-8143-0df94749fbad","name":"Original prompt - v4"},{"parameters":{"resource":"message","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"id"},"content":"<@854284951273078814> que dois-je changer ? (en attente d'un message en dessous de celui-ci)","options":{}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[5968,-1064],"id":"61e1105c-4405-4794-9b52-364b01e2e248","name":"Ask for context - new","webhookId":"f612d56d-9e45-494a-8559-d5b6fbd4c8c1","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"resource":"message","operation":"sendAndWait","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"id"},"message":"=<@854284951273078814> que dois-je changer ?","responseType":"customForm","formFields":{"values":[{"fieldLabel":"Ã‰lÃ©ments Ã  changer","fieldType":"textarea","requiredField":true}]},"options":{"limitWaitTime":{"values":{"limitType":"atSpecifiedTime","maxDateAndTime":"={{ $now.startOf(\"day\").plus(14, \"hours\") }}"}},"appendAttribution":false}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[-432,200],"id":"ef5b83ed-0417-43db-a31d-ffd79e7ed105","name":"Ask for context","webhookId":"f612d56d-9e45-494a-8559-d5b6fbd4c8c1","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"resource":"message","operation":"getAll","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"list","cachedResultName":"ðŸ’¾ãƒ»flo-dump","cachedResultUrl":"https://discord.com/channels/854285298476646421/1438910656307789965"},"limit":5,"options":{"simplify":true}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[6864,-1064],"id":"ae9040ff-27e4-4481-ba99-4c01ca33d551","name":"Get multiple messages in flo-dump (more context)","webhookId":"236ddc49-7a26-449b-b6dd-50019edc9bef","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":3},"conditions":[{"id":"584f0396-7d88-4cd6-9fae-f679350b4aaa","leftValue":"={{ $now }}","rightValue":"={{ $now.startOf(\"day\").plus(14, \"hours\") }}","operator":{"type":"dateTime","operation":"afterOrEquals"}}],"combinator":"and"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.3,"position":[6192,-1064],"id":"c7c21606-28ad-468b-a8a8-6ab583c6e924","name":"If timeout"},{"parameters":{"amount":10},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[6416,-1064],"id":"af78f70a-209e-45ca-b12a-505df85be3b0","name":"Wait 10 seconds","webhookId":"6b9d2e3d-1dfb-472a-b496-13756b39d017"},{"parameters":{"operation":"set","key":"review_flo_dump_context_date","value":"={{ $now.toString() }}","keyType":"string","expire":true,"ttl":86400},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[5744,-1064],"id":"8e9b12a9-11ec-42f9-ad7c-cac6f402e660","name":"Save current time","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"operation":"get","propertyName":"last_context_date","key":"review_flo_dump_context_date","keyType":"string","options":{}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[6640,-1064],"id":"964316cf-0301-4e05-bb90-69fa97b1df59","name":"Get last context time","credentials":{"redis":{"id":"AfgIqWjfLKZzroBz","name":"Redis db 1"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":3},"conditions":[{"id":"ab269b3c-8834-4827-97de-ae5799e842a1","leftValue":"={{ $json.id }}","rightValue":"948183958405906482","operator":{"type":"string","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.3,"position":[7312,-992],"id":"ffe3f07a-d788-4eb8-a231-1a1f836ec960","name":"If reply found"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":3},"conditions":[{"id":"09672288-2db0-497d-bd2a-e2479d156c6f","leftValue":"={{ $json.author.id }}","rightValue":"854284951273078814","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}},{"id":"168699ec-c621-448b-ae3a-faa7b35bf06a","leftValue":"={{ $json.timestamp }}","rightValue":"={{ $('Get last context time').item.json.last_context_date }}","operator":{"type":"dateTime","operation":"after"}}],"combinator":"and"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.filter","typeVersion":2.3,"position":[7088,-1064],"id":"02961c3d-e12b-4937-829d-757d76fed3a5","name":"Filter only Flo messages","alwaysOutputData":true},{"parameters":{"resource":"message","operation":"deleteMessage","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"list","cachedResultName":"ðŸ’¾ãƒ»flo-dump","cachedResultUrl":"https://discord.com/channels/854285298476646421/1438910656307789965"},"messageId":"={{ $('Ask for context - new').item.json.id }}"},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[6416,-1256],"id":"f65ac009-053f-49e7-b17c-e14334bedbcf","name":"Delete ask for context message - timeout","webhookId":"ee8335f9-1b9c-45f2-b1e0-fe5a1da0e0c2","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{"resource":"message","operation":"deleteMessage","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"list","cachedResultName":"ðŸ’¾ãƒ»flo-dump","cachedResultUrl":"https://discord.com/channels/854285298476646421/1438910656307789965"},"messageId":"={{ $('Ask for context - new').item.json.id }}"},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[7760,-992],"id":"96f72895-57d6-4494-97d0-fa79491367f0","name":"Delete ask for context message","webhookId":"ee8335f9-1b9c-45f2-b1e0-fe5a1da0e0c2","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}},{"parameters":{},"type":"n8n-nodes-base.limit","typeVersion":1,"position":[7536,-992],"id":"b7c53b8d-6988-427d-a3c3-9a7e5cdf0285","name":"Limit to last message - context"},{"parameters":{"resource":"message","operation":"react","guildId":{"__rl":true,"value":"854285298476646421","mode":"list","cachedResultName":"Bunkerity","cachedResultUrl":"https://discord.com/channels/854285298476646421"},"channelId":{"__rl":true,"value":"1438910656307789965","mode":"list","cachedResultName":"ðŸ’¾ãƒ»flo-dump","cachedResultUrl":"https://discord.com/channels/854285298476646421/1438910656307789965"},"messageId":"={{ $('Limit to last message - context').item.json.id }}","emoji":"âœ…"},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[7984,-992],"id":"feb4390c-f96f-4572-8122-de9b41690680","name":"React to flo reply","webhookId":"a282b748-9c3c-4fd5-8399-9d17e67808cf","credentials":{"discordBotApi":{"id":"uNaipVUGxj7joc9H","name":"BunkerBot - Prod"}}}],"connections":{"Get messages":{"main":[[{"node":"Get messages from last week","type":"main","index":0}]]},"Sort by date":{"main":[[{"node":"Format messages","type":"main","index":0}]]},"BunkerWeb documentation":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"text-embedding-3-small":{"ai_embedding":[[{"node":"BunkerWeb documentation","type":"ai_embedding","index":0}]]},"AI Agent":{"main":[[{"node":"If message is over 1900 chars","type":"main","index":0}]]},"Think":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Format messages":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"model-router":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Get multiple messages":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Get one message":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Review memory":{"ai_memory":[[{"node":"AI Agent","type":"ai_memory","index":0}]]},"Send review message to flo-dump":{"main":[[{"node":"Cache tmp-review message id","type":"main","index":0}]]},"Review the dump":{"main":[[{"node":"Get multiple messages in flo-dump","type":"main","index":0}]]},"Route decisions":{"main":[[{"node":"Create backlog issue","type":"main","index":0}],[{"node":"Save current time","type":"main","index":0}]]},"Get multiple messages in flo-dump":{"main":[[{"node":"Filter BunkerBot messages","type":"main","index":0}]]},"Filter BunkerBot messages":{"main":[[{"node":"Limit to the last message","type":"main","index":0}]]},"Limit to the last message":{"main":[[{"node":"Delete review message","type":"main","index":0}]]},"Delete review message":{"main":[[{"node":"Increment revisions","type":"main","index":0}]]},"Cache tmp-review message id":{"main":[[{"node":"Set timeout - review","type":"main","index":0}]]},"Delete tmp-review message":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Format fields for agent":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"Get cached tmp-review message id":{"main":[[{"node":"Split message ids","type":"main","index":0}]]},"Send message to tech":{"main":[[{"node":"Get cached tmp-review message id","type":"main","index":0}]]},"Clear today's memory":{"main":[[{"node":"Generate session ID1","type":"main","index":0}]]},"Generate session ID1":{"main":[[{"node":"Clear memory","type":"main","index":0}]]},"Increment revisions":{"main":[[{"node":"Route decisions","type":"main","index":0}]]},"Get revisions number - message":{"main":[[{"node":"Send review message to flo-dump","type":"main","index":0}]]},"Initialize revisions":{"main":[[{"node":"Get messages","type":"main","index":0}]]},"Split message ids":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Loop Over Items":{"main":[[],[{"node":"Delete tmp-review message","type":"main","index":0}]]},"Tavily - Search":{"ai_tool":[[{"node":"TavilyContext","type":"ai_tool","index":0}]]},"Tavily - Extract":{"ai_tool":[[{"node":"TavilyContext","type":"ai_tool","index":0}]]},"Create backlog issue":{"main":[[{"node":"Initialize new retries","type":"main","index":0}]]},"model-router - Tavily":{"ai_languageModel":[[{"node":"TavilyContext","type":"ai_languageModel","index":0}]]},"Review memory - Tavily":{"ai_memory":[[{"node":"TavilyContext","type":"ai_memory","index":0}]]},"TavilyContext":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Filter linked card":{"main":[[{"node":"Limit to 1 ticket","type":"main","index":0}]]},"Update new ticket":{"main":[[{"node":"Send message to tech","type":"main","index":0}]]},"Limit to 1 ticket":{"main":[[{"node":"If ticket is found","type":"main","index":0}]]},"If ticket is found":{"main":[[{"node":"Prepare new fields","type":"main","index":0}],[{"node":"Increment new retries","type":"main","index":0}]]},"Initialize new retries":{"main":[[{"node":"Wait 5 seconds","type":"main","index":0}]]},"Wait 5 seconds":{"main":[[{"node":"Fetch org tickets - flo dump","type":"main","index":0}]]},"If retried to much":{"main":[[{"node":"Get cached tmp-review message id","type":"main","index":0}],[{"node":"Wait 5 seconds","type":"main","index":0}]]},"Increment new retries":{"main":[[{"node":"Get new retries","type":"main","index":0}]]},"Get new retries":{"main":[[{"node":"If retried to much","type":"main","index":0}]]},"Prepare new fields":{"main":[[{"node":"Update new ticket","type":"main","index":0}]]},"Fetch org tickets - flo dump":{"main":[[{"node":"Filter linked card","type":"main","index":0}]]},"Clear memory":{"main":[[{"node":"Clear memory - tavily","type":"main","index":0}]]},"Merge revision / data":{"main":[[{"node":"Send review file to flo-dump","type":"main","index":0}]]},"Get revisions number - file":{"main":[[{"node":"Merge revision / data","type":"main","index":1}]]},"Write Dump to Disk":{"main":[[{"node":"Merge revision / data","type":"main","index":0},{"node":"Get revisions number - file","type":"main","index":0}]]},"Send review file to flo-dump":{"main":[[{"node":"Cache tmp-review message id","type":"main","index":0}]]},"If message is over 1900 chars":{"main":[[{"node":"Convert to File","type":"main","index":0}],[{"node":"Get revisions number - message","type":"main","index":0}]]},"Convert to File":{"main":[[{"node":"Write Dump to Disk","type":"main","index":0}]]},"model-router - fallback":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":1}]]},"Set timeout - review":{"main":[[{"node":"Review the dump","type":"main","index":0}]]},"Get messages from last week":{"main":[[{"node":"Sort by date","type":"main","index":0}]]},"Every friday at 7am":{"main":[[{"node":"Initialize revisions","type":"main","index":0}]]},"Ask for context - new":{"main":[[{"node":"If timeout","type":"main","index":0}]]},"Get multiple messages in flo-dump (more context)":{"main":[[{"node":"Filter only Flo messages","type":"main","index":0}]]},"If timeout":{"main":[[{"node":"Delete ask for context message - timeout","type":"main","index":0}],[{"node":"Wait 10 seconds","type":"main","index":0}]]},"Wait 10 seconds":{"main":[[{"node":"Get last context time","type":"main","index":0}]]},"Save current time":{"main":[[{"node":"Ask for context - new","type":"main","index":0}]]},"Get last context time":{"main":[[{"node":"Get multiple messages in flo-dump (more context)","type":"main","index":0}]]},"Filter only Flo messages":{"main":[[{"node":"If reply found","type":"main","index":0}]]},"If reply found":{"main":[[{"node":"Limit to last message - context","type":"main","index":0}],[{"node":"If timeout","type":"main","index":0}]]},"Delete ask for context message - timeout":{"main":[[{"node":"Create backlog issue","type":"main","index":0}]]},"Delete ask for context message":{"main":[[{"node":"React to flo reply","type":"main","index":0}]]},"Limit to last message - context":{"main":[[{"node":"Delete ask for context message","type":"main","index":0}]]},"React to flo reply":{"main":[[{"node":"Format fields for agent","type":"main","index":0}]]}},"authors":"John Doe","name":"Version 775bb6a4","description":"","autosaved":false},"tags":[{"updatedAt":"2025-08-26T13:05:46.387Z","createdAt":"2025-08-26T13:05:46.387Z","id":"KDJm2H5ESMPxJovN","name":"Bunkerity"}]}